<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="830px" preserveAspectRatio="none" style="width:1165px;height:830px;" version="1.1" viewBox="0 0 1165 830" width="1165px" zoomAndPan="magnify"><defs><filter height="300%" id="f1e3lhs07408xh" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[fa03aa15696d8de1fc436cb9f6abb39b]
cluster p2p--><polygon fill="#FFFFFF" filter="url(#f1e3lhs07408xh)" points="22,24,55,24,62,46.4883,937,46.4883,937,818,22,818,22,24" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="22" x2="62" y1="46.4883" y2="46.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="26" y="39.5352">p2p</text><!--MD5=[7579d5565d2521d5936cec86ed3dadee]
cluster service--><polygon fill="#FFFFFF" filter="url(#f1e3lhs07408xh)" points="961,49.5,1017,49.5,1024,71.9883,1143,71.9883,1143,567.5,961,567.5,961,49.5" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="961" x2="1024" y1="71.9883" y2="71.9883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="50" x="965" y="65.0352">service</text><!--MD5=[311699931f27d41b8a110d6bfb3b1517]
class p2p.BaseReactor--><rect fill="#FEFECE" filter="url(#f1e3lhs07408xh)" height="60.9551" id="p2p.BaseReactor" style="stroke: #A80036; stroke-width: 1.5;" width="103" x="338.5" y="708.5"/><ellipse cx="353.5" cy="724.5" fill="#7FFFD4" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M352.7334,725.563 Q350.8823,724.8574 350.2266,724.0813 Q349.5708,723.3052 349.5708,721.9937 Q349.5708,720.3086 350.6499,719.3457 Q351.729,718.3828 353.6133,718.3828 Q354.4683,718.3828 355.3232,718.5779 Q356.1782,718.7729 357.0166,719.1548 L357.0166,721.5454 Q356.228,720.9893 355.4146,720.6987 Q354.6011,720.4082 353.8042,720.4082 Q352.916,720.4082 352.4429,720.7651 Q351.9697,721.1221 351.9697,721.7861 Q351.9697,722.3008 352.3142,722.637 Q352.6587,722.9731 353.7544,723.3799 L354.8086,723.7783 Q356.3027,724.3262 357.0083,725.231 Q357.7139,726.1357 357.7139,727.5137 Q357.7139,729.3896 356.6057,730.3152 Q355.4976,731.2407 353.2563,731.2407 Q352.335,731.2407 351.4094,731.0208 Q350.4839,730.8008 349.6206,730.3691 L349.6206,727.8374 Q350.6001,728.5347 351.5173,728.875 Q352.4346,729.2153 353.3311,729.2153 Q354.2358,729.2153 354.7339,728.8044 Q355.2319,728.3936 355.2319,727.6548 Q355.2319,727.0986 354.8999,726.6794 Q354.5679,726.2603 353.937,726.0195 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="71" x="367.5" y="729.0352">BaseReactor</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="339.5" x2="440.5" y1="740.5" y2="740.5"/><ellipse cx="349.5" cy="751.5" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="76" x="358.5" y="755.1348">Switch *Switch</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="339.5" x2="440.5" y1="761.4551" y2="761.4551"/><!--MD5=[9fb5b8a8bddc32b7b1ff318042f2b338]
class p2p.IPeerSet--><rect fill="#FEFECE" filter="url(#f1e3lhs07408xh)" height="112.7754" id="p2p.IPeerSet" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="364" y="117"/><ellipse cx="403.3" cy="133" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M399.7277,129.2651 L399.7277,127.1069 L407.1071,127.1069 L407.1071,129.2651 L404.6418,129.2651 L404.6418,137.3418 L407.1071,137.3418 L407.1071,139.5 L399.7277,139.5 L399.7277,137.3418 L402.1931,137.3418 L402.1931,129.2651 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="46" x="422.7" y="137.5352">IPeerSet</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="365" x2="495" y1="149" y2="149"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="365" x2="495" y1="157" y2="157"/><ellipse cx="375" cy="168" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="87" x="384" y="171.6348">Has(key ID) bool</text><ellipse cx="375" cy="180.9551" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="106" x="384" y="184.5898">HasIP(ip net.IP) bool</text><ellipse cx="375" cy="193.9102" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="84" x="384" y="197.5449">Get(key ID) Peer</text><ellipse cx="375" cy="206.8652" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="61" x="384" y="210.5">List() []Peer</text><ellipse cx="375" cy="219.8203" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="46" x="384" y="223.4551">Size() int</text><!--MD5=[53e5f75d9eb4a4b76da8301e97156229]
class p2p.MultiplexTransport--><rect fill="#FEFECE" filter="url(#f1e3lhs07408xh)" height="229.3711" id="p2p.MultiplexTransport" style="stroke: #A80036; stroke-width: 1.5;" width="204" x="38" y="367.5"/><ellipse cx="81.35" cy="383.5" fill="#7FFFD4" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M80.5834,384.563 Q78.7323,383.8574 78.0766,383.0813 Q77.4208,382.3052 77.4208,380.9937 Q77.4208,379.3086 78.4999,378.3457 Q79.579,377.3828 81.4633,377.3828 Q82.3183,377.3828 83.1732,377.5779 Q84.0282,377.7729 84.8666,378.1548 L84.8666,380.5454 Q84.078,379.9893 83.2646,379.6987 Q82.4511,379.4082 81.6542,379.4082 Q80.766,379.4082 80.2929,379.7651 Q79.8197,380.1221 79.8197,380.7861 Q79.8197,381.3008 80.1642,381.637 Q80.5087,381.9731 81.6044,382.3799 L82.6586,382.7783 Q84.1527,383.3262 84.8583,384.231 Q85.5639,385.1357 85.5639,386.5137 Q85.5639,388.3896 84.4557,389.3152 Q83.3476,390.2407 81.1063,390.2407 Q80.185,390.2407 79.2594,390.0208 Q78.3339,389.8008 77.4706,389.3691 L77.4706,386.8374 Q78.4501,387.5347 79.3673,387.875 Q80.2846,388.2153 81.1811,388.2153 Q82.0858,388.2153 82.5839,387.8044 Q83.0819,387.3936 83.0819,386.6548 Q83.0819,386.0986 82.7499,385.6794 Q82.4179,385.2603 81.787,385.0195 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="109" x="101.65" y="388.0352">MultiplexTransport</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="39" x2="241" y1="399.5" y2="399.5"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="46" y="407.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="110" x="58" y="414.1348">netAddr NetAddress</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="46" y="420.4551"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="106" x="58" y="427.0898">listener net.Listener</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="46" y="433.4102"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="158" x="58" y="440.0449">maxIncomingConnections int</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="46" y="446.3652"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="41" x="58" y="453">acceptc</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="26" x="102" y="453">chan</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="35" x="131" y="453">accept</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="46" y="459.3203"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="34" x="58" y="465.9551">closec</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="26" x="95" y="465.9551">chan</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="124" y="465.9551"/><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="32" x="124" y="465.9551">struct</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="8" x="156" y="465.9551">{}</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="46" y="472.2754"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="81" x="58" y="478.9102">conns ConnSet</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="46" y="485.2305"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="153" x="58" y="491.8652">connFilters []ConnFilterFunc</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="46" y="498.1855"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="139" x="58" y="504.8203">dialTimeout time.Duration</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="46" y="511.1406"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="145" x="58" y="517.7754">filterTimeout time.Duration</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="46" y="524.0957"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="178" x="58" y="530.7305">handshakeTimeout time.Duration</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="46" y="537.0508"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="100" x="58" y="543.6855">nodeInfo NodeInfo</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="46" y="550.0059"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="96" x="58" y="556.6406">nodeKey NodeKey</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="46" y="562.9609"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="102" x="58" y="569.5957">resolver IPResolver</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="46" y="575.916"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="153" x="58" y="582.5508">mConfig conn.MConnConfig</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="39" x2="241" y1="588.8711" y2="588.8711"/><!--MD5=[e3e52a252a583c20fdaae9f735fd57de]
class p2p.Peer--><rect fill="#FEFECE" filter="url(#f1e3lhs07408xh)" height="229.3711" id="p2p.Peer" style="stroke: #A80036; stroke-width: 1.5;" width="195" x="725.5" y="59"/><ellipse cx="805.75" cy="75" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M802.1777,71.2651 L802.1777,69.1069 L809.5571,69.1069 L809.5571,71.2651 L807.0918,71.2651 L807.0918,79.3418 L809.5571,79.3418 L809.5571,81.5 L802.1777,81.5 L802.1777,79.3418 L804.6431,79.3418 L804.6431,71.2651 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="26" x="826.25" y="79.5352">Peer</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="726.5" x2="919.5" y1="91" y2="91"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="726.5" x2="919.5" y1="99" y2="99"/><ellipse cx="736.5" cy="110" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="61" x="745.5" y="113.6348">FlushStop()</text><ellipse cx="736.5" cy="122.9551" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="33" x="745.5" y="126.5898">ID() ID</text><ellipse cx="736.5" cy="135.9102" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="89" x="745.5" y="139.5449">RemoteIP() net.IP</text><ellipse cx="736.5" cy="148.8652" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="125" x="745.5" y="152.5">RemoteAddr() net.Addr</text><ellipse cx="736.5" cy="161.8203" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="99" x="745.5" y="165.4551">IsOutbound() bool</text><ellipse cx="736.5" cy="174.7754" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="97" x="745.5" y="178.4102">IsPersistent() bool</text><ellipse cx="736.5" cy="187.7305" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="98" x="745.5" y="191.3652">CloseConn() error</text><ellipse cx="736.5" cy="200.6855" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="109" x="745.5" y="204.3203">NodeInfo() NodeInfo</text><ellipse cx="736.5" cy="213.6406" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="169" x="745.5" y="217.2754">Status() conn.ConnectionStatus</text><ellipse cx="736.5" cy="226.5957" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="141" x="745.5" y="230.2305">SocketAddr() *NetAddress</text><ellipse cx="736.5" cy="239.5508" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="127" x="745.5" y="243.1855">Send( byte,  []byte) bool</text><ellipse cx="736.5" cy="252.5059" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="145" x="745.5" y="256.1406">TrySend( byte,  []byte) bool</text><ellipse cx="736.5" cy="265.4609" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="58" x="745.5" y="269.0957">Set( string,</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="47" x="809.5" y="269.0957">interface</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="12" x="856.5" y="269.0957">{})</text><ellipse cx="736.5" cy="278.416" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="61" x="745.5" y="282.0508">Get( string)</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="47" x="809.5" y="282.0508">interface</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="8" x="856.5" y="282.0508">{}</text><!--MD5=[573edd832eea7a8264afd9f9040bf970]
class p2p.PeerSet--><rect fill="#FEFECE" filter="url(#f1e3lhs07408xh)" height="99.8203" id="p2p.PeerSet" style="stroke: #A80036; stroke-width: 1.5;" width="176" x="538" y="432"/><ellipse cx="600.25" cy="448" fill="#7FFFD4" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M599.4834,449.063 Q597.6323,448.3574 596.9766,447.5813 Q596.3208,446.8052 596.3208,445.4937 Q596.3208,443.8086 597.3999,442.8457 Q598.479,441.8828 600.3633,441.8828 Q601.2183,441.8828 602.0732,442.0779 Q602.9282,442.2729 603.7666,442.6548 L603.7666,445.0454 Q602.978,444.4893 602.1646,444.1987 Q601.3511,443.9082 600.5542,443.9082 Q599.666,443.9082 599.1929,444.2651 Q598.7197,444.6221 598.7197,445.2861 Q598.7197,445.8008 599.0642,446.137 Q599.4087,446.4731 600.5044,446.8799 L601.5586,447.2783 Q603.0527,447.8262 603.7583,448.731 Q604.4639,449.6357 604.4639,451.0137 Q604.4639,452.8896 603.3557,453.8152 Q602.2476,454.7407 600.0063,454.7407 Q599.085,454.7407 598.1594,454.5208 Q597.2339,454.3008 596.3706,453.8691 L596.3706,451.3374 Q597.3501,452.0347 598.2673,452.375 Q599.1846,452.7153 600.0811,452.7153 Q600.9858,452.7153 601.4839,452.3044 Q601.9819,451.8936 601.9819,451.1548 Q601.9819,450.5986 601.6499,450.1794 Q601.3179,449.7603 600.687,449.5195 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="43" x="620.75" y="452.5352">PeerSet</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="539" x2="713" y1="464" y2="464"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="546" y="472"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="85" x="558" y="478.6348">mtx sync.Mutex</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="546" y="484.9551"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="37" x="558" y="491.5898">lookup</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="23" x="598" y="491.5898">map</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="87" x="621" y="491.5898">[ID]*peerSetItem</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="546" y="497.9102"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="50" x="558" y="504.5449">list []Peer</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="539" x2="713" y1="510.8652" y2="510.8652"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="546" y="518.8652"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="128" x="558" y="525.5">hasIP(peerIP net.IP) bool</text><!--MD5=[37628d08395bda41cda4b3616adc29df]
class p2p.Reactor--><rect fill="#FEFECE" filter="url(#f1e3lhs07408xh)" height="125.7305" id="p2p.Reactor" style="stroke: #A80036; stroke-width: 1.5;" width="271" x="476.5" y="676"/><ellipse cx="585.75" cy="692" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M582.1777,688.2651 L582.1777,686.1069 L589.5571,686.1069 L589.5571,688.2651 L587.0918,688.2651 L587.0918,696.3418 L589.5571,696.3418 L589.5571,698.5 L582.1777,698.5 L582.1777,696.3418 L584.6431,696.3418 L584.6431,688.2651 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="44" x="606.25" y="696.5352">Reactor</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="477.5" x2="746.5" y1="708" y2="708"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="477.5" x2="746.5" y1="716" y2="716"/><ellipse cx="487.5" cy="727" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="100" x="496.5" y="730.6348">SetSwitch( *Switch)</text><ellipse cx="487.5" cy="739.9551" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="223" x="496.5" y="743.5898">GetChannels() []*conn.ChannelDescriptor</text><ellipse cx="487.5" cy="752.9102" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="124" x="496.5" y="756.5449">InitPeer(peer Peer) Peer</text><ellipse cx="487.5" cy="765.8652" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="103" x="496.5" y="769.5">AddPeer(peer Peer)</text><ellipse cx="487.5" cy="778.8203" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="162" x="496.5" y="782.4551">RemovePeer(peer Peer, reason</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="47" x="661.5" y="782.4551">interface</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="12" x="708.5" y="782.4551">{})</text><ellipse cx="487.5" cy="791.7754" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="245" x="496.5" y="795.4102">Receive(chID byte, peer Peer, msgBytes []byte)</text><!--MD5=[b34240524190d792e7d8883f18bd4dc7]
class p2p.Switch--><rect fill="#FEFECE" filter="url(#f1e3lhs07408xh)" height="268.2363" id="p2p.Switch" style="stroke: #A80036; stroke-width: 1.5;" width="225" x="277.5" y="348"/><ellipse cx="368.25" cy="364" fill="#7FFFD4" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M367.4834,365.063 Q365.6323,364.3574 364.9766,363.5813 Q364.3208,362.8052 364.3208,361.4937 Q364.3208,359.8086 365.3999,358.8457 Q366.479,357.8828 368.3633,357.8828 Q369.2183,357.8828 370.0732,358.0779 Q370.9282,358.2729 371.7666,358.6548 L371.7666,361.0454 Q370.978,360.4893 370.1646,360.1987 Q369.3511,359.9082 368.5542,359.9082 Q367.666,359.9082 367.1929,360.2651 Q366.7197,360.6221 366.7197,361.2861 Q366.7197,361.8008 367.0642,362.137 Q367.4087,362.4731 368.5044,362.8799 L369.5586,363.2783 Q371.0527,363.8262 371.7583,364.731 Q372.4639,365.6357 372.4639,367.0137 Q372.4639,368.8896 371.3557,369.8152 Q370.2476,370.7407 368.0063,370.7407 Q367.085,370.7407 366.1594,370.5208 Q365.2339,370.3008 364.3706,369.8691 L364.3706,367.3374 Q365.3501,368.0347 366.2673,368.375 Q367.1846,368.7153 368.0811,368.7153 Q368.9858,368.7153 369.4839,368.3044 Q369.9819,367.8936 369.9819,367.1548 Q369.9819,366.5986 369.6499,366.1794 Q369.3179,365.7603 368.687,365.5195 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="35" x="388.75" y="368.5352">Switch</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="278.5" x2="501.5" y1="380" y2="380"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="285.5" y="388"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="134" x="297.5" y="394.6348">config *config.P2PConfig</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="285.5" y="400.9551"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="45" x="297.5" y="407.5898">reactors</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="23" x="345.5" y="407.5898">map</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="81" x="368.5" y="407.5898">[string]Reactor</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="285.5" y="413.9102"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="192" x="297.5" y="420.5449">chDescs []*conn.ChannelDescriptor</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="285.5" y="426.8652"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="72" x="297.5" y="433.5">reactorsByCh</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="23" x="372.5" y="433.5">map</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="72" x="395.5" y="433.5">[byte]Reactor</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="285.5" y="439.8203"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="77" x="297.5" y="446.4551">peers *PeerSet</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="285.5" y="452.7754"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="106" x="297.5" y="459.4102">dialing *cmap.CMap</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="285.5" y="465.7305"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="141" x="297.5" y="472.3652">reconnecting *cmap.CMap</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="285.5" y="478.6855"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="100" x="297.5" y="485.3203">nodeInfo NodeInfo</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="285.5" y="491.6406"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="101" x="297.5" y="498.2754">nodeKey *NodeKey</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="285.5" y="504.5957"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="107" x="297.5" y="511.2305">addrBook AddrBook</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="285.5" y="517.5508"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="195" x="297.5" y="524.1855">persistentPeersAddrs []*NetAddress</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="285.5" y="530.5059"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="114" x="297.5" y="537.1406">unconditionalPeerIDs</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="23" x="414.5" y="537.1406">map</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="19" x="437.5" y="537.1406">[ID]</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="32" x="456.5" y="537.1406">struct</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="8" x="488.5" y="537.1406">{}</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="285.5" y="543.4609"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="108" x="297.5" y="550.0957">transport Transport</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="285.5" y="556.416"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="145" x="297.5" y="563.0508">filterTimeout time.Duration</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="285.5" y="569.3711"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="144" x="297.5" y="576.0059">peerFilters []PeerFilterFunc</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="285.5" y="582.3262"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="82" x="297.5" y="588.9609">rng *rand.Rand</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="285.5" y="595.2813"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="87" x="297.5" y="601.916">metrics *Metrics</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="278.5" x2="501.5" y1="608.2363" y2="608.2363"/><!--MD5=[18cff6f764bb194711d9f5dd93f9c958]
class p2p.Transport--><rect fill="#FEFECE" filter="url(#f1e3lhs07408xh)" height="99.8203" id="p2p.Transport" style="stroke: #A80036; stroke-width: 1.5;" width="257" x="38.5" y="123.5"/><ellipse cx="134.25" cy="139.5" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M130.6777,135.7651 L130.6777,133.6069 L138.0571,133.6069 L138.0571,135.7651 L135.5918,135.7651 L135.5918,143.8418 L138.0571,143.8418 L138.0571,146 L130.6777,146 L130.6777,143.8418 L133.1431,143.8418 L133.1431,135.7651 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="57" x="154.75" y="144.0352">Transport</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="39.5" x2="294.5" y1="155.5" y2="155.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="39.5" x2="294.5" y1="163.5" y2="163.5"/><ellipse cx="49.5" cy="174.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="137" x="58.5" y="178.1348">NetAddress() NetAddress</text><ellipse cx="49.5" cy="187.4551" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="176" x="58.5" y="191.0898">Accept( peerConfig) (Peer, error)</text><ellipse cx="49.5" cy="200.4102" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="231" x="58.5" y="204.0449">Dial( NetAddress,  peerConfig) (Peer, error)</text><ellipse cx="49.5" cy="213.3652" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="78" x="58.5" y="217">Cleanup( Peer)</text><!--MD5=[6fef2d861d215382f2c7392a760d324d]
class p2p.peer--><rect fill="#FEFECE" filter="url(#f1e3lhs07408xh)" height="138.6855" id="p2p.peer" style="stroke: #A80036; stroke-width: 1.5;" width="172" x="749" y="412.5"/><ellipse cx="817.25" cy="428.5" fill="#7FFFD4" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M816.4834,429.563 Q814.6323,428.8574 813.9766,428.0813 Q813.3208,427.3052 813.3208,425.9937 Q813.3208,424.3086 814.3999,423.3457 Q815.479,422.3828 817.3633,422.3828 Q818.2183,422.3828 819.0732,422.5779 Q819.9282,422.7729 820.7666,423.1548 L820.7666,425.5454 Q819.978,424.9893 819.1646,424.6987 Q818.3511,424.4082 817.5542,424.4082 Q816.666,424.4082 816.1929,424.7651 Q815.7197,425.1221 815.7197,425.7861 Q815.7197,426.3008 816.0642,426.637 Q816.4087,426.9731 817.5044,427.3799 L818.5586,427.7783 Q820.0527,428.3262 820.7583,429.231 Q821.4639,430.1357 821.4639,431.5137 Q821.4639,433.3896 820.3557,434.3152 Q819.2476,435.2407 817.0063,435.2407 Q816.085,435.2407 815.1594,435.0208 Q814.2339,434.8008 813.3706,434.3691 L813.3706,431.8374 Q814.3501,432.5347 815.2673,432.875 Q816.1846,433.2153 817.0811,433.2153 Q817.9858,433.2153 818.4839,432.8044 Q818.9819,432.3936 818.9819,431.6548 Q818.9819,431.0986 818.6499,430.6794 Q818.3179,430.2603 817.687,430.0195 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="27" x="837.75" y="433.0352">peer</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="750" x2="920" y1="444.5" y2="444.5"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="757" y="452.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="146" x="769" y="459.1348">mconn *conn.MConnection</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="757" y="465.4551"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="100" x="769" y="472.0898">nodeInfo NodeInfo</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="757" y="478.4102"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="82" x="769" y="485.0449">channels []byte</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="757" y="491.3652"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="87" x="769" y="498">metrics *Metrics</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="757" y="504.3203"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="140" x="769" y="510.9551">metricsTicker *time.Ticker</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="772" y="523.9102"/><ellipse cx="760" cy="533.2305" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="94" x="769" y="536.8652">Data *cmap.CMap</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="750" x2="920" y1="543.1855" y2="543.1855"/><!--MD5=[f2ba958c56ea10e04681f7ec6c9a06ea]
class p2p.peerConn--><rect fill="#FEFECE" filter="url(#f1e3lhs07408xh)" height="151.6406" id="p2p.peerConn" style="stroke: #A80036; stroke-width: 1.5;" width="159" x="531.5" y="97.5"/><ellipse cx="578.75" cy="113.5" fill="#7FFFD4" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M577.9834,114.563 Q576.1323,113.8574 575.4766,113.0813 Q574.8208,112.3052 574.8208,110.9937 Q574.8208,109.3086 575.8999,108.3457 Q576.979,107.3828 578.8633,107.3828 Q579.7183,107.3828 580.5732,107.5779 Q581.4282,107.7729 582.2666,108.1548 L582.2666,110.5454 Q581.478,109.9893 580.6646,109.6987 Q579.8511,109.4082 579.0542,109.4082 Q578.166,109.4082 577.6929,109.7651 Q577.2197,110.1221 577.2197,110.7861 Q577.2197,111.3008 577.5642,111.637 Q577.9087,111.9731 579.0044,112.3799 L580.0586,112.7783 Q581.5527,113.3262 582.2583,114.231 Q582.9639,115.1357 582.9639,116.5137 Q582.9639,118.3896 581.8557,119.3152 Q580.7476,120.2407 578.5063,120.2407 Q577.585,120.2407 576.6594,120.0208 Q575.7339,119.8008 574.8706,119.3691 L574.8706,116.8374 Q575.8501,117.5347 576.7673,117.875 Q577.6846,118.2153 578.5811,118.2153 Q579.4858,118.2153 579.9839,117.8044 Q580.4819,117.3936 580.4819,116.6548 Q580.4819,116.0986 580.1499,115.6794 Q579.8179,115.2603 579.187,115.0195 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="56" x="599.25" y="118.0352">peerConn</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="532.5" x2="689.5" y1="129.5" y2="129.5"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="539.5" y="137.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="80" x="551.5" y="144.1348">outbound bool</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="539.5" y="150.4551"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="81" x="551.5" y="157.0898">persistent bool</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="539.5" y="163.4102"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="79" x="551.5" y="170.0449">conn net.Conn</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="539.5" y="176.3652"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="133" x="551.5" y="183">socketAddr *NetAddress</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="539.5" y="189.3203"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="42" x="551.5" y="195.9551">ip net.IP</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="532.5" x2="689.5" y1="202.2754" y2="202.2754"/><ellipse cx="542.5" cy="213.2754" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="33" x="551.5" y="216.9102">ID() ID</text><ellipse cx="542.5" cy="226.2305" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="89" x="551.5" y="229.8652">RemoteIP() net.IP</text><ellipse cx="542.5" cy="239.1855" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="67" x="551.5" y="242.8203">CloseConn()</text><!--MD5=[c22516aed28ee4c58d2db0be50dce8ef]
class p2p.transportLifecycle--><rect fill="#FEFECE" filter="url(#f1e3lhs07408xh)" height="73.9102" id="p2p.transportLifecycle" style="stroke: #A80036; stroke-width: 1.5;" width="163" x="58.5" y="702"/><ellipse cx="87" cy="718" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M83.4277,714.2651 L83.4277,712.1069 L90.8071,712.1069 L90.8071,714.2651 L88.3418,714.2651 L88.3418,722.3418 L90.8071,722.3418 L90.8071,724.5 L83.4277,724.5 L83.4277,722.3418 L85.8931,722.3418 L85.8931,714.2651 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="101" x="104" y="722.5352">transportLifecycle</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="59.5" x2="220.5" y1="734" y2="734"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="59.5" x2="220.5" y1="742" y2="742"/><ellipse cx="69.5" cy="753" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="69" x="78.5" y="756.6348">Close() error</text><ellipse cx="69.5" cy="765.9551" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="137" x="78.5" y="769.5898">Listen( NetAddress) error</text><!--MD5=[f90addf20bd1e85cf17f517894494b4c]
class service.BaseService--><rect fill="#FEFECE" filter="url(#f1e3lhs07408xh)" height="138.6855" id="service.BaseService" style="stroke: #A80036; stroke-width: 1.5;" width="125" x="977.5" y="412.5"/><ellipse cx="1004.2" cy="428.5" fill="#7FFFD4" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1003.4334,429.563 Q1001.5823,428.8574 1000.9266,428.0813 Q1000.2708,427.3052 1000.2708,425.9937 Q1000.2708,424.3086 1001.3499,423.3457 Q1002.429,422.3828 1004.3133,422.3828 Q1005.1683,422.3828 1006.0232,422.5779 Q1006.8782,422.7729 1007.7166,423.1548 L1007.7166,425.5454 Q1006.928,424.9893 1006.1146,424.6987 Q1005.3011,424.4082 1004.5042,424.4082 Q1003.616,424.4082 1003.1429,424.7651 Q1002.6697,425.1221 1002.6697,425.7861 Q1002.6697,426.3008 1003.0142,426.637 Q1003.3587,426.9731 1004.4544,427.3799 L1005.5086,427.7783 Q1007.0027,428.3262 1007.7083,429.231 Q1008.4139,430.1357 1008.4139,431.5137 Q1008.4139,433.3896 1007.3057,434.3152 Q1006.1976,435.2407 1003.9563,435.2407 Q1003.035,435.2407 1002.1094,435.0208 Q1001.1839,434.8008 1000.3206,434.3691 L1000.3206,431.8374 Q1001.3001,432.5347 1002.2173,432.875 Q1003.1346,433.2153 1004.0311,433.2153 Q1004.9358,433.2153 1005.4339,432.8044 Q1005.9319,432.3936 1005.9319,431.6548 Q1005.9319,431.0986 1005.5999,430.6794 Q1005.2679,430.2603 1004.637,430.0195 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="67" x="1020.8" y="433.0352">BaseService</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="978.5" x2="1101.5" y1="444.5" y2="444.5"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="985.5" y="452.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="64" x="997.5" y="459.1348">name string</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="985.5" y="465.4551"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="76" x="997.5" y="472.0898">started uint32</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="985.5" y="478.4102"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="82" x="997.5" y="485.0449">stopped uint32</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="985.5" y="491.3652"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="21" x="997.5" y="498">quit</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="26" x="1021.5" y="498">chan</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="1050.5" y="498"/><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="32" x="1050.5" y="498">struct</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="8" x="1082.5" y="498">{}</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="985.5" y="504.3203"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="64" x="997.5" y="510.9551">impl Service</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="1000.5" y="523.9102"/><ellipse cx="988.5" cy="533.2305" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="99" x="997.5" y="536.8652">Logger log.Logger</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="978.5" x2="1101.5" y1="543.1855" y2="543.1855"/><!--MD5=[fd25aa4d66dcc726e577441cd7f3c4c1]
class service.Service--><rect fill="#FEFECE" filter="url(#f1e3lhs07408xh)" height="177.5508" id="service.Service" style="stroke: #A80036; stroke-width: 1.5;" width="149" x="977.5" y="84.5"/><ellipse cx="1027.75" cy="100.5" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1024.1777,96.7651 L1024.1777,94.6069 L1031.5571,94.6069 L1031.5571,96.7651 L1029.0918,96.7651 L1029.0918,104.8418 L1031.5571,104.8418 L1031.5571,107 L1024.1777,107 L1024.1777,104.8418 L1026.6431,104.8418 L1026.6431,96.7651 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="40" x="1048.25" y="105.0352">Service</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="978.5" x2="1125.5" y1="116.5" y2="116.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="978.5" x2="1125.5" y1="124.5" y2="124.5"/><ellipse cx="988.5" cy="135.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="64" x="997.5" y="139.1348">Start() error</text><ellipse cx="988.5" cy="148.4551" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="80" x="997.5" y="152.0898">OnStart() error</text><ellipse cx="988.5" cy="161.4102" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="63" x="997.5" y="165.0449">Stop() error</text><ellipse cx="988.5" cy="174.3652" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="48" x="997.5" y="178">OnStop()</text><ellipse cx="988.5" cy="187.3203" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="68" x="997.5" y="190.9551">Reset() error</text><ellipse cx="988.5" cy="200.2754" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="84" x="997.5" y="203.9102">OnReset() error</text><ellipse cx="988.5" cy="213.2305" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="89" x="997.5" y="216.8652">IsRunning() bool</text><ellipse cx="988.5" cy="226.1855" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="31" x="997.5" y="229.8203">Quit()</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="26" x="1031.5" y="229.8203">chan</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="1060.5" y="229.8203"/><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="32" x="1060.5" y="229.8203">struct</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="8" x="1092.5" y="229.8203">{}</text><ellipse cx="988.5" cy="239.1406" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="75" x="997.5" y="242.7754">String() string</text><ellipse cx="988.5" cy="252.0957" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="123" x="997.5" y="255.7305">SetLogger( log.Logger)</text><!--MD5=[ac75108900a7da53673606bc12d5f375]
reverse link service.Service to service.BaseService--><path d="M1047.76,282.77 C1046.07,325.87 1044.18,374.18 1042.69,412.32 " fill="none" id="service.Service&lt;-service.BaseService" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1040.77,282.45,1048.55,262.74,1054.76,283,1040.77,282.45" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[b3ca9392012dbc1ca56a23f1d34c5e32]
reverse link service.BaseService to p2p.BaseReactor--><path d="M994.51,562.52 C978.9,583.13 959.57,603.12 937,616 C751.02,722.08 653.76,587.05 459,676 C442.59,683.49 427.34,696.3 415.36,708.33 " fill="none" id="service.BaseService&lt;-p2p.BaseReactor" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1002.33,551.72,995.5705,554.2317,995.2892,561.4374,1002.0487,558.9256,1002.33,551.72" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[37fcf60b90146dd4e50b73ee638398fe]
link p2p.BaseReactor to p2p.Reactor--><path d="M441.6,739 C446.47,739 451.33,739 456.2,739 " fill="none" id="p2p.BaseReactor-&gt;p2p.Reactor" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="456.21,732,476.21,739,456.21,746,456.21,732" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[b9fbf2a7effaeaefa17c476384a1dba2]
reverse link p2p.peerConn to p2p.peer--><path d="M673.9,260.57 C709,308.59 752.12,367.6 784.91,412.47 " fill="none" id="p2p.peerConn&lt;-p2p.peer" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="666.08,249.87,666.3898,257.0744,673.1592,259.5594,672.8494,252.355,666.08,249.87" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[a4829d3d32a44b3a8142c2ba0a35b7f2]
reverse link service.BaseService to p2p.peer--><path d="M964.12,482 C949.77,482 935.43,482 921.08,482 " fill="none" id="service.BaseService&lt;-p2p.peer" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="977.29,482,971.29,478,965.29,482,971.29,486,977.29,482" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[0c3700d192805ae30ab006e56b4633f3]
reverse link p2p.Transport to p2p.MultiplexTransport--><path d="M160.9,243.77 C157.69,280.22 153.67,325.83 150.02,367.29 " fill="none" id="p2p.Transport&lt;-p2p.MultiplexTransport" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="153.93,243.05,162.66,223.74,167.88,244.28,153.93,243.05" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[2c9f51bc795756116b03063064369ede]
link p2p.MultiplexTransport to p2p.transportLifecycle--><path d="M140,596.7 C140,626.23 140,656.76 140,681.85 " fill="none" id="p2p.MultiplexTransport-&gt;p2p.transportLifecycle" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="147,681.92,140,701.92,133,681.92,147,681.92" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[050d08726fdf1574cedda3f8be396e30]
reverse link p2p.IPeerSet to p2p.PeerSet--><path d="M476.36,246.99 C512.85,304.06 562.72,382.04 594.65,431.98 " fill="none" id="p2p.IPeerSet&lt;-p2p.PeerSet" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="470.37,250.63,465.49,230,482.17,243.08,470.37,250.63" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[a88ba8938669b8d1f443f70d77216d8b]
reverse link p2p.Peer to p2p.peer--><path d="M828.24,308.27 C829.65,344.23 831.11,381.66 832.32,412.44 " fill="none" id="p2p.Peer&lt;-p2p.peer" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="821.24,308.45,827.45,288.19,835.23,307.9,821.24,308.45" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[13142556ca77b4ea3786758c1200ed69]
link p2p.Switch to service.BaseService--><path d="M497.52,347.92 C508.28,340.08 519.69,333.26 531.67,328 C571.72,310.42 886.24,308.37 925.33,328 C956.63,343.72 981.55,372.47 1000.05,400.91 " fill="none" id="p2p.Switch-&gt;service.BaseService" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1007.09,412.19,1007.3121,404.9823,1000.7442,402.0051,1000.5222,409.2128,1007.09,412.19" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[6e480aef305aad66a6c56b9453c18417]
link p2p.Switch to p2p.BaseReactor--><path d="M377.26,616.1 C377.39,648.43 378.61,680.29 380.93,703.32 " fill="none" id="p2p.Switch-&gt;p2p.BaseReactor" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="381.47,708.39,384.4694,699.009,380.9272,703.4195,376.5167,699.8774,381.47,708.39" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="324.0493" y="636.8568">reactors</text><!--MD5=[b14611813044e641dc988996b3ed6edd]
reverse link p2p.Switch to p2p.BaseReactor--><path d="M403.46,621.39 C403.19,654.33 401.72,686.29 399.03,708.39 " fill="none" id="p2p.Switch&lt;-p2p.BaseReactor" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="403.49,616.1,399.4386,625.077,403.4614,621.0999,407.4385,625.1227,403.49,616.1" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="41" x="355.5209" y="697.6607">Switch</text><!--MD5=[a924b6e98268a62b9e927706709f5ae4]
link p2p.Switch to p2p.PeerSet--><path d="M502.93,482 C512.75,482 522.58,482 532.41,482 " fill="none" id="p2p.Switch-&gt;p2p.PeerSet" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="537.54,482,528.54,478,532.54,482,528.54,486,537.54,482" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="34" x="510.3724" y="478.187">peers</text><!--MD5=[9fe161fb271e8b8d4eeb24ae21c077f8]
reverse link p2p.MultiplexTransport to p2p.Switch--><path d="M247.28,482 C257.29,482 267.3,482 277.3,482 " fill="none" id="p2p.MultiplexTransport&lt;-p2p.Switch" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="242.05,482,251.05,486,247.05,482,251.05,478,242.05,482" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="211.5204" y="474.1571">transport</text><!--MD5=[5dec3acfd8f3e3e3c796fe4f98622533]
link p2p.PeerSet to p2p.peer--><path d="M714.17,482 C723.95,482 733.73,482 743.51,482 " fill="none" id="p2p.PeerSet-&gt;p2p.peer" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="748.63,482,739.63,478,743.63,482,739.63,486,748.63,482" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="20" x="720.8663" y="478.9053">list</text><!--MD5=[66749d24604890fc737f8ae18158200f]
@startuml
namespace p2p {
    class BaseReactor << (S,Aquamarine) >> {
        + Switch *Switch

    }
    interface IPeerSet  {
        + Has(key ID) bool
        + HasIP(ip net.IP) bool
        + Get(key ID) Peer
        + List() []Peer
        + Size() int

    }
    class MultiplexTransport << (S,Aquamarine) >> {
        - netAddr NetAddress
        - listener net.Listener
        - maxIncomingConnections int
        - acceptc <font color=blue>chan</font> accept
        - closec <font color=blue>chan</font> <font color=blue>struct</font>{}
        - conns ConnSet
        - connFilters []ConnFilterFunc
        - dialTimeout time.Duration
        - filterTimeout time.Duration
        - handshakeTimeout time.Duration
        - nodeInfo NodeInfo
        - nodeKey NodeKey
        - resolver IPResolver
        - mConfig conn.MConnConfig
 
    }
    interface Peer  {
        + FlushStop() 
        + ID() ID
        + RemoteIP() net.IP
        + RemoteAddr() net.Addr
        + IsOutbound() bool
        + IsPersistent() bool
        + CloseConn() error
        + NodeInfo() NodeInfo
        + Status() conn.ConnectionStatus
        + SocketAddr() *NetAddress
        + Send( byte,  []byte) bool
        + TrySend( byte,  []byte) bool
        + Set( string,  <font color=blue>interface</font>{}) 
        + Get( string) <font color=blue>interface</font>{}

    }
    class PeerSet << (S,Aquamarine) >> {
        - mtx sync.Mutex
        - lookup <font color=blue>map</font>[ID]*peerSetItem
        - list []Peer

        - hasIP(peerIP net.IP) bool

    }
    interface Reactor  {
        + SetSwitch( *Switch) 
        + GetChannels() []*conn.ChannelDescriptor
        + InitPeer(peer Peer) Peer
        + AddPeer(peer Peer) 
        + RemovePeer(peer Peer, reason <font color=blue>interface</font>{}) 
        + Receive(chID byte, peer Peer, msgBytes []byte) 

    }
    class Switch << (S,Aquamarine) >> {
        - config *config.P2PConfig
        - reactors <font color=blue>map</font>[string]Reactor
        - chDescs []*conn.ChannelDescriptor
        - reactorsByCh <font color=blue>map</font>[byte]Reactor
        - peers *PeerSet
        - dialing *cmap.CMap
        - reconnecting *cmap.CMap
        - nodeInfo NodeInfo
        - nodeKey *NodeKey
        - addrBook AddrBook
        - persistentPeersAddrs []*NetAddress
        - unconditionalPeerIDs <font color=blue>map</font>[ID]<font color=blue>struct</font>{}
        - transport Transport
        - filterTimeout time.Duration
        - peerFilters []PeerFilterFunc
        - rng *rand.Rand
        - metrics *Metrics

    }
    interface Transport  {
        + NetAddress() NetAddress
        + Accept( peerConfig) (Peer, error)
        + Dial( NetAddress,  peerConfig) (Peer, error)
        + Cleanup( Peer) 

    }
    class peer << (S,Aquamarine) >> {
        - mconn *conn.MConnection
        - nodeInfo NodeInfo
        - channels []byte
        - metrics *Metrics
        - metricsTicker *time.Ticker

        + Data *cmap.CMap

    }
    class peerConn << (S,Aquamarine) >> {
        - outbound bool
        - persistent bool
        - conn net.Conn
        - socketAddr *NetAddress
        - ip net.IP

        + ID() ID
        + RemoteIP() net.IP
        + CloseConn() 

    }
    interface transportLifecycle  {
        + Close() error
        + Listen( NetAddress) error

    }
}

namespace service {
    class BaseService << (S,Aquamarine) >> {
        - name string
        - started uint32
        - stopped uint32
        - quit <font color=blue>chan</font> <font color=blue>struct</font>{}
        - impl Service

        + Logger log.Logger
        
    }
    interface Service  {
        + Start() error
        + OnStart() error
        + Stop() error
        + OnStop() 
        + Reset() error
        + OnReset() error
        + IsRunning() bool
        + Quit() <font color=blue>chan</font> <font color=blue>struct</font>{}
        + String() string
        + SetLogger( log.Logger) 

    }
}

"service.Service" <|- - "service.BaseService"

"service.BaseService" *- - "p2p.BaseReactor"
"p2p.Reactor" <|-left "p2p.BaseReactor"

"p2p.peerConn" *- - "p2p.peer"
"service.BaseService" *- - "p2p.peer"


"p2p.Transport" <|- - "p2p.MultiplexTransport"
"p2p.transportLifecycle" <|-up- "p2p.MultiplexTransport"
"p2p.IPeerSet" <|- - "p2p.PeerSet"

"p2p.Peer" <|- - "p2p.peer"

"service.BaseService" *-up- "p2p.Switch"
"p2p.BaseReactor" <.down. "reactors" "p2p.Switch"
"p2p.PeerSet" <.right "peers" "p2p.Switch"
"p2p.MultiplexTransport" <.left "transport" "p2p.Switch"
 "p2p.Switch" <.. "Switch" "p2p.BaseReactor"

"p2p.peer" <.right "list" "p2p.PeerSet"


@enduml

PlantUML version 1.2019.13(Wed Dec 11 01:18:29 CST 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 13.0.1+9
Operating System: Mac OS X
Default Encoding: UTF-8
Language: en
Country: CN
--></g></svg>