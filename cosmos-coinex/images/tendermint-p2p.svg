<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="830px" preserveAspectRatio="none" style="width:1330px;height:830px;" version="1.1" viewBox="0 0 1330 830" width="1330px" zoomAndPan="magnify"><defs><filter height="300%" id="fe87pagj8gwrq" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[fa03aa15696d8de1fc436cb9f6abb39b]
cluster p2p--><polygon fill="#FFFFFF" filter="url(#fe87pagj8gwrq)" points="22,24,55,24,62,46.4883,1102,46.4883,1102,818,22,818,22,24" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="22" x2="62" y1="46.4883" y2="46.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="26" y="39.5352">p2p</text><!--MD5=[7579d5565d2521d5936cec86ed3dadee]
cluster service--><polygon fill="#FFFFFF" filter="url(#fe87pagj8gwrq)" points="1126,49.5,1182,49.5,1189,71.9883,1308,71.9883,1308,567.5,1126,567.5,1126,49.5" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="1126" x2="1189" y1="71.9883" y2="71.9883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="50" x="1130" y="65.0352">service</text><!--MD5=[311699931f27d41b8a110d6bfb3b1517]
class p2p.BaseReactor--><rect fill="#FEFECE" filter="url(#fe87pagj8gwrq)" height="60.9551" id="p2p.BaseReactor" style="stroke: #A80036; stroke-width: 1.5;" width="103" x="497.5" y="708.5"/><ellipse cx="512.5" cy="724.5" fill="#7FFFD4" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M511.7334,725.563 Q509.8823,724.8574 509.2266,724.0813 Q508.5708,723.3052 508.5708,721.9937 Q508.5708,720.3086 509.6499,719.3457 Q510.729,718.3828 512.6133,718.3828 Q513.4683,718.3828 514.3232,718.5779 Q515.1782,718.7729 516.0166,719.1548 L516.0166,721.5454 Q515.228,720.9893 514.4146,720.6987 Q513.6011,720.4082 512.8042,720.4082 Q511.916,720.4082 511.4429,720.7651 Q510.9697,721.1221 510.9697,721.7861 Q510.9697,722.3008 511.3142,722.637 Q511.6587,722.9731 512.7544,723.3799 L513.8086,723.7783 Q515.3027,724.3262 516.0083,725.231 Q516.7139,726.1357 516.7139,727.5137 Q516.7139,729.3896 515.6057,730.3152 Q514.4976,731.2407 512.2563,731.2407 Q511.335,731.2407 510.4094,731.0208 Q509.4839,730.8008 508.6206,730.3691 L508.6206,727.8374 Q509.6001,728.5347 510.5173,728.875 Q511.4346,729.2153 512.3311,729.2153 Q513.2358,729.2153 513.7339,728.8044 Q514.2319,728.3936 514.2319,727.6548 Q514.2319,727.0986 513.8999,726.6794 Q513.5679,726.2603 512.937,726.0195 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="71" x="526.5" y="729.0352">BaseReactor</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="498.5" x2="599.5" y1="740.5" y2="740.5"/><ellipse cx="508.5" cy="751.5" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="76" x="517.5" y="755.1348">Switch *Switch</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="498.5" x2="599.5" y1="761.4551" y2="761.4551"/><!--MD5=[9fb5b8a8bddc32b7b1ff318042f2b338]
class p2p.IPeerSet--><rect fill="#FEFECE" filter="url(#fe87pagj8gwrq)" height="112.7754" id="p2p.IPeerSet" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="529" y="117"/><ellipse cx="568.3" cy="133" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M564.7277,129.2651 L564.7277,127.1069 L572.1071,127.1069 L572.1071,129.2651 L569.6418,129.2651 L569.6418,137.3418 L572.1071,137.3418 L572.1071,139.5 L564.7277,139.5 L564.7277,137.3418 L567.1931,137.3418 L567.1931,129.2651 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="46" x="587.7" y="137.5352">IPeerSet</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="530" x2="660" y1="149" y2="149"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="530" x2="660" y1="157" y2="157"/><ellipse cx="540" cy="168" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="87" x="549" y="171.6348">Has(key ID) bool</text><ellipse cx="540" cy="180.9551" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="106" x="549" y="184.5898">HasIP(ip net.IP) bool</text><ellipse cx="540" cy="193.9102" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="84" x="549" y="197.5449">Get(key ID) Peer</text><ellipse cx="540" cy="206.8652" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="61" x="549" y="210.5">List() []Peer</text><ellipse cx="540" cy="219.8203" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="46" x="549" y="223.4551">Size() int</text><!--MD5=[53e5f75d9eb4a4b76da8301e97156229]
class p2p.MultiplexTransport--><rect fill="#FEFECE" filter="url(#fe87pagj8gwrq)" height="229.3711" id="p2p.MultiplexTransport" style="stroke: #A80036; stroke-width: 1.5;" width="204" x="197" y="367.5"/><ellipse cx="240.35" cy="383.5" fill="#7FFFD4" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M239.5834,384.563 Q237.7323,383.8574 237.0766,383.0813 Q236.4208,382.3052 236.4208,380.9937 Q236.4208,379.3086 237.4999,378.3457 Q238.579,377.3828 240.4633,377.3828 Q241.3183,377.3828 242.1732,377.5779 Q243.0282,377.7729 243.8666,378.1548 L243.8666,380.5454 Q243.078,379.9893 242.2646,379.6987 Q241.4511,379.4082 240.6542,379.4082 Q239.766,379.4082 239.2929,379.7651 Q238.8197,380.1221 238.8197,380.7861 Q238.8197,381.3008 239.1642,381.637 Q239.5087,381.9731 240.6044,382.3799 L241.6586,382.7783 Q243.1527,383.3262 243.8583,384.231 Q244.5639,385.1357 244.5639,386.5137 Q244.5639,388.3896 243.4557,389.3152 Q242.3476,390.2407 240.1063,390.2407 Q239.185,390.2407 238.2594,390.0208 Q237.3339,389.8008 236.4706,389.3691 L236.4706,386.8374 Q237.4501,387.5347 238.3673,387.875 Q239.2846,388.2153 240.1811,388.2153 Q241.0858,388.2153 241.5839,387.8044 Q242.0819,387.3936 242.0819,386.6548 Q242.0819,386.0986 241.7499,385.6794 Q241.4179,385.2603 240.787,385.0195 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="109" x="260.65" y="388.0352">MultiplexTransport</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="198" x2="400" y1="399.5" y2="399.5"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="205" y="407.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="110" x="217" y="414.1348">netAddr NetAddress</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="205" y="420.4551"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="106" x="217" y="427.0898">listener net.Listener</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="205" y="433.4102"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="158" x="217" y="440.0449">maxIncomingConnections int</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="205" y="446.3652"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="41" x="217" y="453">acceptc</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="26" x="261" y="453">chan</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="35" x="290" y="453">accept</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="205" y="459.3203"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="34" x="217" y="465.9551">closec</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="26" x="254" y="465.9551">chan</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="283" y="465.9551"/><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="32" x="283" y="465.9551">struct</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="8" x="315" y="465.9551">{}</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="205" y="472.2754"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="81" x="217" y="478.9102">conns ConnSet</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="205" y="485.2305"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="153" x="217" y="491.8652">connFilters []ConnFilterFunc</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="205" y="498.1855"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="139" x="217" y="504.8203">dialTimeout time.Duration</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="205" y="511.1406"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="145" x="217" y="517.7754">filterTimeout time.Duration</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="205" y="524.0957"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="178" x="217" y="530.7305">handshakeTimeout time.Duration</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="205" y="537.0508"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="100" x="217" y="543.6855">nodeInfo NodeInfo</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="205" y="550.0059"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="96" x="217" y="556.6406">nodeKey NodeKey</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="205" y="562.9609"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="102" x="217" y="569.5957">resolver IPResolver</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="205" y="575.916"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="153" x="217" y="582.5508">mConfig conn.MConnConfig</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="198" x2="400" y1="588.8711" y2="588.8711"/><!--MD5=[e3e52a252a583c20fdaae9f735fd57de]
class p2p.Peer--><rect fill="#FEFECE" filter="url(#fe87pagj8gwrq)" height="229.3711" id="p2p.Peer" style="stroke: #A80036; stroke-width: 1.5;" width="195" x="890.5" y="59"/><ellipse cx="970.75" cy="75" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M967.1777,71.2651 L967.1777,69.1069 L974.5571,69.1069 L974.5571,71.2651 L972.0918,71.2651 L972.0918,79.3418 L974.5571,79.3418 L974.5571,81.5 L967.1777,81.5 L967.1777,79.3418 L969.6431,79.3418 L969.6431,71.2651 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="26" x="991.25" y="79.5352">Peer</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="891.5" x2="1084.5" y1="91" y2="91"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="891.5" x2="1084.5" y1="99" y2="99"/><ellipse cx="901.5" cy="110" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="61" x="910.5" y="113.6348">FlushStop()</text><ellipse cx="901.5" cy="122.9551" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="33" x="910.5" y="126.5898">ID() ID</text><ellipse cx="901.5" cy="135.9102" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="89" x="910.5" y="139.5449">RemoteIP() net.IP</text><ellipse cx="901.5" cy="148.8652" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="125" x="910.5" y="152.5">RemoteAddr() net.Addr</text><ellipse cx="901.5" cy="161.8203" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="99" x="910.5" y="165.4551">IsOutbound() bool</text><ellipse cx="901.5" cy="174.7754" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="97" x="910.5" y="178.4102">IsPersistent() bool</text><ellipse cx="901.5" cy="187.7305" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="98" x="910.5" y="191.3652">CloseConn() error</text><ellipse cx="901.5" cy="200.6855" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="109" x="910.5" y="204.3203">NodeInfo() NodeInfo</text><ellipse cx="901.5" cy="213.6406" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="169" x="910.5" y="217.2754">Status() conn.ConnectionStatus</text><ellipse cx="901.5" cy="226.5957" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="141" x="910.5" y="230.2305">SocketAddr() *NetAddress</text><ellipse cx="901.5" cy="239.5508" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="127" x="910.5" y="243.1855">Send( byte,  []byte) bool</text><ellipse cx="901.5" cy="252.5059" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="145" x="910.5" y="256.1406">TrySend( byte,  []byte) bool</text><ellipse cx="901.5" cy="265.4609" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="58" x="910.5" y="269.0957">Set( string,</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="47" x="974.5" y="269.0957">interface</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="12" x="1021.5" y="269.0957">{})</text><ellipse cx="901.5" cy="278.416" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="61" x="910.5" y="282.0508">Get( string)</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="47" x="974.5" y="282.0508">interface</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="8" x="1021.5" y="282.0508">{}</text><!--MD5=[573edd832eea7a8264afd9f9040bf970]
class p2p.PeerSet--><rect fill="#FEFECE" filter="url(#fe87pagj8gwrq)" height="99.8203" id="p2p.PeerSet" style="stroke: #A80036; stroke-width: 1.5;" width="176" x="697" y="432"/><ellipse cx="759.25" cy="448" fill="#7FFFD4" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M758.4834,449.063 Q756.6323,448.3574 755.9766,447.5813 Q755.3208,446.8052 755.3208,445.4937 Q755.3208,443.8086 756.3999,442.8457 Q757.479,441.8828 759.3633,441.8828 Q760.2183,441.8828 761.0732,442.0779 Q761.9282,442.2729 762.7666,442.6548 L762.7666,445.0454 Q761.978,444.4893 761.1646,444.1987 Q760.3511,443.9082 759.5542,443.9082 Q758.666,443.9082 758.1929,444.2651 Q757.7197,444.6221 757.7197,445.2861 Q757.7197,445.8008 758.0642,446.137 Q758.4087,446.4731 759.5044,446.8799 L760.5586,447.2783 Q762.0527,447.8262 762.7583,448.731 Q763.4639,449.6357 763.4639,451.0137 Q763.4639,452.8896 762.3557,453.8152 Q761.2476,454.7407 759.0063,454.7407 Q758.085,454.7407 757.1594,454.5208 Q756.2339,454.3008 755.3706,453.8691 L755.3706,451.3374 Q756.3501,452.0347 757.2673,452.375 Q758.1846,452.7153 759.0811,452.7153 Q759.9858,452.7153 760.4839,452.3044 Q760.9819,451.8936 760.9819,451.1548 Q760.9819,450.5986 760.6499,450.1794 Q760.3179,449.7603 759.687,449.5195 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="43" x="779.75" y="452.5352">PeerSet</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="698" x2="872" y1="464" y2="464"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="705" y="472"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="85" x="717" y="478.6348">mtx sync.Mutex</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="705" y="484.9551"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="37" x="717" y="491.5898">lookup</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="23" x="757" y="491.5898">map</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="87" x="780" y="491.5898">[ID]*peerSetItem</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="705" y="497.9102"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="50" x="717" y="504.5449">list []Peer</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="698" x2="872" y1="510.8652" y2="510.8652"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="705" y="518.8652"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="128" x="717" y="525.5">hasIP(peerIP net.IP) bool</text><!--MD5=[37628d08395bda41cda4b3616adc29df]
class p2p.Reactor--><rect fill="#FEFECE" filter="url(#fe87pagj8gwrq)" height="125.7305" id="p2p.Reactor" style="stroke: #A80036; stroke-width: 1.5;" width="271" x="635.5" y="676"/><ellipse cx="744.75" cy="692" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M741.1777,688.2651 L741.1777,686.1069 L748.5571,686.1069 L748.5571,688.2651 L746.0918,688.2651 L746.0918,696.3418 L748.5571,696.3418 L748.5571,698.5 L741.1777,698.5 L741.1777,696.3418 L743.6431,696.3418 L743.6431,688.2651 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="44" x="765.25" y="696.5352">Reactor</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="636.5" x2="905.5" y1="708" y2="708"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="636.5" x2="905.5" y1="716" y2="716"/><ellipse cx="646.5" cy="727" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="100" x="655.5" y="730.6348">SetSwitch( *Switch)</text><ellipse cx="646.5" cy="739.9551" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="223" x="655.5" y="743.5898">GetChannels() []*conn.ChannelDescriptor</text><ellipse cx="646.5" cy="752.9102" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="124" x="655.5" y="756.5449">InitPeer(peer Peer) Peer</text><ellipse cx="646.5" cy="765.8652" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="103" x="655.5" y="769.5">AddPeer(peer Peer)</text><ellipse cx="646.5" cy="778.8203" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="162" x="655.5" y="782.4551">RemovePeer(peer Peer, reason</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="47" x="820.5" y="782.4551">interface</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="12" x="867.5" y="782.4551">{})</text><ellipse cx="646.5" cy="791.7754" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="245" x="655.5" y="795.4102">Receive(chID byte, peer Peer, msgBytes []byte)</text><!--MD5=[b34240524190d792e7d8883f18bd4dc7]
class p2p.Switch--><rect fill="#FEFECE" filter="url(#fe87pagj8gwrq)" height="268.2363" id="p2p.Switch" style="stroke: #A80036; stroke-width: 1.5;" width="225" x="436.5" y="348"/><ellipse cx="527.25" cy="364" fill="#7FFFD4" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M526.4834,365.063 Q524.6323,364.3574 523.9766,363.5813 Q523.3208,362.8052 523.3208,361.4937 Q523.3208,359.8086 524.3999,358.8457 Q525.479,357.8828 527.3633,357.8828 Q528.2183,357.8828 529.0732,358.0779 Q529.9282,358.2729 530.7666,358.6548 L530.7666,361.0454 Q529.978,360.4893 529.1646,360.1987 Q528.3511,359.9082 527.5542,359.9082 Q526.666,359.9082 526.1929,360.2651 Q525.7197,360.6221 525.7197,361.2861 Q525.7197,361.8008 526.0642,362.137 Q526.4087,362.4731 527.5044,362.8799 L528.5586,363.2783 Q530.0527,363.8262 530.7583,364.731 Q531.4639,365.6357 531.4639,367.0137 Q531.4639,368.8896 530.3557,369.8152 Q529.2476,370.7407 527.0063,370.7407 Q526.085,370.7407 525.1594,370.5208 Q524.2339,370.3008 523.3706,369.8691 L523.3706,367.3374 Q524.3501,368.0347 525.2673,368.375 Q526.1846,368.7153 527.0811,368.7153 Q527.9858,368.7153 528.4839,368.3044 Q528.9819,367.8936 528.9819,367.1548 Q528.9819,366.5986 528.6499,366.1794 Q528.3179,365.7603 527.687,365.5195 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="35" x="547.75" y="368.5352">Switch</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="437.5" x2="660.5" y1="380" y2="380"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="444.5" y="388"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="134" x="456.5" y="394.6348">config *config.P2PConfig</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="444.5" y="400.9551"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="45" x="456.5" y="407.5898">reactors</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="23" x="504.5" y="407.5898">map</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="81" x="527.5" y="407.5898">[string]Reactor</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="444.5" y="413.9102"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="192" x="456.5" y="420.5449">chDescs []*conn.ChannelDescriptor</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="444.5" y="426.8652"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="72" x="456.5" y="433.5">reactorsByCh</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="23" x="531.5" y="433.5">map</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="72" x="554.5" y="433.5">[byte]Reactor</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="444.5" y="439.8203"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="77" x="456.5" y="446.4551">peers *PeerSet</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="444.5" y="452.7754"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="106" x="456.5" y="459.4102">dialing *cmap.CMap</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="444.5" y="465.7305"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="141" x="456.5" y="472.3652">reconnecting *cmap.CMap</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="444.5" y="478.6855"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="100" x="456.5" y="485.3203">nodeInfo NodeInfo</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="444.5" y="491.6406"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="101" x="456.5" y="498.2754">nodeKey *NodeKey</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="444.5" y="504.5957"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="107" x="456.5" y="511.2305">addrBook AddrBook</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="444.5" y="517.5508"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="195" x="456.5" y="524.1855">persistentPeersAddrs []*NetAddress</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="444.5" y="530.5059"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="114" x="456.5" y="537.1406">unconditionalPeerIDs</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="23" x="573.5" y="537.1406">map</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="19" x="596.5" y="537.1406">[ID]</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="32" x="615.5" y="537.1406">struct</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="8" x="647.5" y="537.1406">{}</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="444.5" y="543.4609"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="108" x="456.5" y="550.0957">transport Transport</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="444.5" y="556.416"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="145" x="456.5" y="563.0508">filterTimeout time.Duration</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="444.5" y="569.3711"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="144" x="456.5" y="576.0059">peerFilters []PeerFilterFunc</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="444.5" y="582.3262"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="82" x="456.5" y="588.9609">rng *rand.Rand</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="444.5" y="595.2813"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="87" x="456.5" y="601.916">metrics *Metrics</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="437.5" x2="660.5" y1="608.2363" y2="608.2363"/><!--MD5=[18cff6f764bb194711d9f5dd93f9c958]
class p2p.Transport--><rect fill="#FEFECE" filter="url(#fe87pagj8gwrq)" height="99.8203" id="p2p.Transport" style="stroke: #A80036; stroke-width: 1.5;" width="257" x="236.5" y="123.5"/><ellipse cx="332.25" cy="139.5" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M328.6777,135.7651 L328.6777,133.6069 L336.0571,133.6069 L336.0571,135.7651 L333.5918,135.7651 L333.5918,143.8418 L336.0571,143.8418 L336.0571,146 L328.6777,146 L328.6777,143.8418 L331.1431,143.8418 L331.1431,135.7651 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="57" x="352.75" y="144.0352">Transport</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="237.5" x2="492.5" y1="155.5" y2="155.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="237.5" x2="492.5" y1="163.5" y2="163.5"/><ellipse cx="247.5" cy="174.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="137" x="256.5" y="178.1348">NetAddress() NetAddress</text><ellipse cx="247.5" cy="187.4551" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="176" x="256.5" y="191.0898">Accept( peerConfig) (Peer, error)</text><ellipse cx="247.5" cy="200.4102" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="231" x="256.5" y="204.0449">Dial( NetAddress,  peerConfig) (Peer, error)</text><ellipse cx="247.5" cy="213.3652" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="78" x="256.5" y="217">Cleanup( Peer)</text><!--MD5=[6fef2d861d215382f2c7392a760d324d]
class p2p.peer--><rect fill="#FEFECE" filter="url(#fe87pagj8gwrq)" height="138.6855" id="p2p.peer" style="stroke: #A80036; stroke-width: 1.5;" width="172" x="908" y="412.5"/><ellipse cx="976.25" cy="428.5" fill="#7FFFD4" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M975.4834,429.563 Q973.6323,428.8574 972.9766,428.0813 Q972.3208,427.3052 972.3208,425.9937 Q972.3208,424.3086 973.3999,423.3457 Q974.479,422.3828 976.3633,422.3828 Q977.2183,422.3828 978.0732,422.5779 Q978.9282,422.7729 979.7666,423.1548 L979.7666,425.5454 Q978.978,424.9893 978.1646,424.6987 Q977.3511,424.4082 976.5542,424.4082 Q975.666,424.4082 975.1929,424.7651 Q974.7197,425.1221 974.7197,425.7861 Q974.7197,426.3008 975.0642,426.637 Q975.4087,426.9731 976.5044,427.3799 L977.5586,427.7783 Q979.0527,428.3262 979.7583,429.231 Q980.4639,430.1357 980.4639,431.5137 Q980.4639,433.3896 979.3557,434.3152 Q978.2476,435.2407 976.0063,435.2407 Q975.085,435.2407 974.1594,435.0208 Q973.2339,434.8008 972.3706,434.3691 L972.3706,431.8374 Q973.3501,432.5347 974.2673,432.875 Q975.1846,433.2153 976.0811,433.2153 Q976.9858,433.2153 977.4839,432.8044 Q977.9819,432.3936 977.9819,431.6548 Q977.9819,431.0986 977.6499,430.6794 Q977.3179,430.2603 976.687,430.0195 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="27" x="996.75" y="433.0352">peer</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="909" x2="1079" y1="444.5" y2="444.5"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="916" y="452.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="146" x="928" y="459.1348">mconn *conn.MConnection</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="916" y="465.4551"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="100" x="928" y="472.0898">nodeInfo NodeInfo</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="916" y="478.4102"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="82" x="928" y="485.0449">channels []byte</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="916" y="491.3652"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="87" x="928" y="498">metrics *Metrics</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="916" y="504.3203"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="140" x="928" y="510.9551">metricsTicker *time.Ticker</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="931" y="523.9102"/><ellipse cx="919" cy="533.2305" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="94" x="928" y="536.8652">Data *cmap.CMap</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="909" x2="1079" y1="543.1855" y2="543.1855"/><!--MD5=[f2ba958c56ea10e04681f7ec6c9a06ea]
class p2p.peerConn--><rect fill="#FEFECE" filter="url(#fe87pagj8gwrq)" height="151.6406" id="p2p.peerConn" style="stroke: #A80036; stroke-width: 1.5;" width="159" x="696.5" y="97.5"/><ellipse cx="743.75" cy="113.5" fill="#7FFFD4" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M742.9834,114.563 Q741.1323,113.8574 740.4766,113.0813 Q739.8208,112.3052 739.8208,110.9937 Q739.8208,109.3086 740.8999,108.3457 Q741.979,107.3828 743.8633,107.3828 Q744.7183,107.3828 745.5732,107.5779 Q746.4282,107.7729 747.2666,108.1548 L747.2666,110.5454 Q746.478,109.9893 745.6646,109.6987 Q744.8511,109.4082 744.0542,109.4082 Q743.166,109.4082 742.6929,109.7651 Q742.2197,110.1221 742.2197,110.7861 Q742.2197,111.3008 742.5642,111.637 Q742.9087,111.9731 744.0044,112.3799 L745.0586,112.7783 Q746.5527,113.3262 747.2583,114.231 Q747.9639,115.1357 747.9639,116.5137 Q747.9639,118.3896 746.8557,119.3152 Q745.7476,120.2407 743.5063,120.2407 Q742.585,120.2407 741.6594,120.0208 Q740.7339,119.8008 739.8706,119.3691 L739.8706,116.8374 Q740.8501,117.5347 741.7673,117.875 Q742.6846,118.2153 743.5811,118.2153 Q744.4858,118.2153 744.9839,117.8044 Q745.4819,117.3936 745.4819,116.6548 Q745.4819,116.0986 745.1499,115.6794 Q744.8179,115.2603 744.187,115.0195 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="56" x="764.25" y="118.0352">peerConn</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="697.5" x2="854.5" y1="129.5" y2="129.5"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="704.5" y="137.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="80" x="716.5" y="144.1348">outbound bool</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="704.5" y="150.4551"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="81" x="716.5" y="157.0898">persistent bool</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="704.5" y="163.4102"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="79" x="716.5" y="170.0449">conn net.Conn</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="704.5" y="176.3652"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="133" x="716.5" y="183">socketAddr *NetAddress</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="704.5" y="189.3203"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="42" x="716.5" y="195.9551">ip net.IP</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="697.5" x2="854.5" y1="202.2754" y2="202.2754"/><ellipse cx="707.5" cy="213.2754" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="33" x="716.5" y="216.9102">ID() ID</text><ellipse cx="707.5" cy="226.2305" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="89" x="716.5" y="229.8652">RemoteIP() net.IP</text><ellipse cx="707.5" cy="239.1855" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="67" x="716.5" y="242.8203">CloseConn()</text><!--MD5=[c22516aed28ee4c58d2db0be50dce8ef]
class p2p.transportLifecycle--><rect fill="#FEFECE" filter="url(#fe87pagj8gwrq)" height="73.9102" id="p2p.transportLifecycle" style="stroke: #A80036; stroke-width: 1.5;" width="163" x="38.5" y="136.5"/><ellipse cx="67" cy="152.5" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M63.4277,148.7651 L63.4277,146.6069 L70.8071,146.6069 L70.8071,148.7651 L68.3418,148.7651 L68.3418,156.8418 L70.8071,156.8418 L70.8071,159 L63.4277,159 L63.4277,156.8418 L65.8931,156.8418 L65.8931,148.7651 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="101" x="84" y="157.0352">transportLifecycle</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="39.5" x2="200.5" y1="168.5" y2="168.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="39.5" x2="200.5" y1="176.5" y2="176.5"/><ellipse cx="49.5" cy="187.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="69" x="58.5" y="191.1348">Close() error</text><ellipse cx="49.5" cy="200.4551" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="137" x="58.5" y="204.0898">Listen( NetAddress) error</text><!--MD5=[f90addf20bd1e85cf17f517894494b4c]
class service.BaseService--><rect fill="#FEFECE" filter="url(#fe87pagj8gwrq)" height="138.6855" id="service.BaseService" style="stroke: #A80036; stroke-width: 1.5;" width="125" x="1142.5" y="412.5"/><ellipse cx="1169.2" cy="428.5" fill="#7FFFD4" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1168.4334,429.563 Q1166.5823,428.8574 1165.9266,428.0813 Q1165.2708,427.3052 1165.2708,425.9937 Q1165.2708,424.3086 1166.3499,423.3457 Q1167.429,422.3828 1169.3133,422.3828 Q1170.1683,422.3828 1171.0232,422.5779 Q1171.8782,422.7729 1172.7166,423.1548 L1172.7166,425.5454 Q1171.928,424.9893 1171.1146,424.6987 Q1170.3011,424.4082 1169.5042,424.4082 Q1168.616,424.4082 1168.1429,424.7651 Q1167.6697,425.1221 1167.6697,425.7861 Q1167.6697,426.3008 1168.0142,426.637 Q1168.3587,426.9731 1169.4544,427.3799 L1170.5086,427.7783 Q1172.0027,428.3262 1172.7083,429.231 Q1173.4139,430.1357 1173.4139,431.5137 Q1173.4139,433.3896 1172.3057,434.3152 Q1171.1976,435.2407 1168.9563,435.2407 Q1168.035,435.2407 1167.1094,435.0208 Q1166.1839,434.8008 1165.3206,434.3691 L1165.3206,431.8374 Q1166.3001,432.5347 1167.2173,432.875 Q1168.1346,433.2153 1169.0311,433.2153 Q1169.9358,433.2153 1170.4339,432.8044 Q1170.9319,432.3936 1170.9319,431.6548 Q1170.9319,431.0986 1170.5999,430.6794 Q1170.2679,430.2603 1169.637,430.0195 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="67" x="1185.8" y="433.0352">BaseService</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1143.5" x2="1266.5" y1="444.5" y2="444.5"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1150.5" y="452.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="64" x="1162.5" y="459.1348">name string</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1150.5" y="465.4551"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="76" x="1162.5" y="472.0898">started uint32</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1150.5" y="478.4102"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="82" x="1162.5" y="485.0449">stopped uint32</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1150.5" y="491.3652"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="21" x="1162.5" y="498">quit</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="26" x="1186.5" y="498">chan</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="1215.5" y="498"/><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="32" x="1215.5" y="498">struct</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="8" x="1247.5" y="498">{}</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="1150.5" y="504.3203"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="64" x="1162.5" y="510.9551">impl Service</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="1165.5" y="523.9102"/><ellipse cx="1153.5" cy="533.2305" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="99" x="1162.5" y="536.8652">Logger log.Logger</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1143.5" x2="1266.5" y1="543.1855" y2="543.1855"/><!--MD5=[fd25aa4d66dcc726e577441cd7f3c4c1]
class service.Service--><rect fill="#FEFECE" filter="url(#fe87pagj8gwrq)" height="177.5508" id="service.Service" style="stroke: #A80036; stroke-width: 1.5;" width="149" x="1142.5" y="84.5"/><ellipse cx="1192.75" cy="100.5" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1189.1777,96.7651 L1189.1777,94.6069 L1196.5571,94.6069 L1196.5571,96.7651 L1194.0918,96.7651 L1194.0918,104.8418 L1196.5571,104.8418 L1196.5571,107 L1189.1777,107 L1189.1777,104.8418 L1191.6431,104.8418 L1191.6431,96.7651 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="40" x="1213.25" y="105.0352">Service</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1143.5" x2="1290.5" y1="116.5" y2="116.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1143.5" x2="1290.5" y1="124.5" y2="124.5"/><ellipse cx="1153.5" cy="135.5" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="64" x="1162.5" y="139.1348">Start() error</text><ellipse cx="1153.5" cy="148.4551" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="80" x="1162.5" y="152.0898">OnStart() error</text><ellipse cx="1153.5" cy="161.4102" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="63" x="1162.5" y="165.0449">Stop() error</text><ellipse cx="1153.5" cy="174.3652" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="48" x="1162.5" y="178">OnStop()</text><ellipse cx="1153.5" cy="187.3203" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="68" x="1162.5" y="190.9551">Reset() error</text><ellipse cx="1153.5" cy="200.2754" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="84" x="1162.5" y="203.9102">OnReset() error</text><ellipse cx="1153.5" cy="213.2305" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="89" x="1162.5" y="216.8652">IsRunning() bool</text><ellipse cx="1153.5" cy="226.1855" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="31" x="1162.5" y="229.8203">Quit()</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="26" x="1196.5" y="229.8203">chan</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="1225.5" y="229.8203"/><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="32" x="1225.5" y="229.8203">struct</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="8" x="1257.5" y="229.8203">{}</text><ellipse cx="1153.5" cy="239.1406" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="75" x="1162.5" y="242.7754">String() string</text><ellipse cx="1153.5" cy="252.0957" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="123" x="1162.5" y="255.7305">SetLogger( log.Logger)</text><!--MD5=[ac75108900a7da53673606bc12d5f375]
reverse link service.Service to service.BaseService--><path d="M1212.76,282.77 C1211.07,325.87 1209.18,374.18 1207.69,412.32 " fill="none" id="service.Service&lt;-service.BaseService" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1205.77,282.45,1213.55,262.74,1219.76,283,1205.77,282.45" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[b3ca9392012dbc1ca56a23f1d34c5e32]
reverse link service.BaseService to p2p.BaseReactor--><path d="M1159.52,562.54 C1143.91,583.15 1124.58,603.14 1102,616 C913.63,723.25 815.23,586.1 618,676 C601.59,683.48 586.33,696.28 574.36,708.32 " fill="none" id="service.BaseService&lt;-p2p.BaseReactor" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1167.34,551.74,1160.5805,554.2517,1160.2992,561.4574,1167.0587,558.9456,1167.34,551.74" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[37fcf60b90146dd4e50b73ee638398fe]
link p2p.BaseReactor to p2p.Reactor--><path d="M600.6,739 C605.47,739 610.33,739 615.2,739 " fill="none" id="p2p.BaseReactor-&gt;p2p.Reactor" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="615.21,732,635.21,739,615.21,746,615.21,732" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[b9fbf2a7effaeaefa17c476384a1dba2]
reverse link p2p.peerConn to p2p.peer--><path d="M837.22,260.57 C871.38,308.59 913.34,367.6 945.26,412.47 " fill="none" id="p2p.peerConn&lt;-p2p.peer" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="829.61,249.87,829.8278,257.0778,836.5649,259.649,836.3471,252.4412,829.61,249.87" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[a4829d3d32a44b3a8142c2ba0a35b7f2]
reverse link service.BaseService to p2p.peer--><path d="M1129.01,482 C1112.72,482 1096.42,482 1080.13,482 " fill="none" id="service.BaseService&lt;-p2p.peer" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1142.08,482,1136.08,478,1130.08,482,1136.08,486,1142.08,482" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[0c3700d192805ae30ab006e56b4633f3]
reverse link p2p.Transport to p2p.MultiplexTransport--><path d="M350.14,243.52 C342.28,280 332.44,325.73 323.49,367.29 " fill="none" id="p2p.Transport&lt;-p2p.MultiplexTransport" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="343.34,241.82,354.4,223.74,357.03,244.77,343.34,241.82" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[5fcf14daa37ccae53c4b796a0afc96ba]
reverse link p2p.transportLifecycle to p2p.MultiplexTransport--><path d="M151.18,227.88 C173.62,266.31 204.72,319.57 232.62,367.33 " fill="none" id="p2p.transportLifecycle&lt;-p2p.MultiplexTransport" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="145.1,231.36,141.06,210.56,157.19,224.3,145.1,231.36" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[050d08726fdf1574cedda3f8be396e30]
reverse link p2p.IPeerSet to p2p.PeerSet--><path d="M640.17,247.36 C675.52,304.39 723.72,382.15 754.61,431.98 " fill="none" id="p2p.IPeerSet&lt;-p2p.PeerSet" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="634,250.69,629.41,230,645.89,243.32,634,250.69" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[a88ba8938669b8d1f443f70d77216d8b]
reverse link p2p.Peer to p2p.peer--><path d="M990.62,308.27 C991.32,344.23 992.06,381.66 992.66,412.44 " fill="none" id="p2p.Peer&lt;-p2p.peer" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="983.62,308.33,990.23,288.19,997.62,308.05,983.62,308.33" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[13142556ca77b4ea3786758c1200ed69]
link p2p.Switch to service.BaseService--><path d="M657.36,347.91 C668.18,340.07 679.64,333.25 691.67,328 C732.26,310.27 1050.75,308.12 1090.33,328 C1121.63,343.72 1146.55,372.47 1165.05,400.91 " fill="none" id="p2p.Switch-&gt;service.BaseService" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1172.09,412.19,1172.3121,404.9823,1165.7442,402.0051,1165.5222,409.2128,1172.09,412.19" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[6e480aef305aad66a6c56b9453c18417]
link p2p.Switch to p2p.BaseReactor--><path d="M536.26,616.1 C536.39,648.43 537.61,680.29 539.93,703.32 " fill="none" id="p2p.Switch-&gt;p2p.BaseReactor" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="540.47,708.39,543.4694,699.009,539.9272,703.4195,535.5167,699.8774,540.47,708.39" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="483.0493" y="636.8568">reactors</text><!--MD5=[b14611813044e641dc988996b3ed6edd]
reverse link p2p.Switch to p2p.BaseReactor--><path d="M562.46,621.39 C562.19,654.33 560.72,686.29 558.03,708.39 " fill="none" id="p2p.Switch&lt;-p2p.BaseReactor" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="562.49,616.1,558.4386,625.077,562.4614,621.0999,566.4385,625.1227,562.49,616.1" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="41" x="514.5209" y="697.6607">Switch</text><!--MD5=[a924b6e98268a62b9e927706709f5ae4]
link p2p.Switch to p2p.PeerSet--><path d="M661.93,482 C671.75,482 681.58,482 691.41,482 " fill="none" id="p2p.Switch-&gt;p2p.PeerSet" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="696.54,482,687.54,478,691.54,482,687.54,486,696.54,482" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="34" x="669.3724" y="478.187">peers</text><!--MD5=[9fe161fb271e8b8d4eeb24ae21c077f8]
reverse link p2p.MultiplexTransport to p2p.Switch--><path d="M406.28,482 C416.29,482 426.3,482 436.3,482 " fill="none" id="p2p.MultiplexTransport&lt;-p2p.Switch" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="401.05,482,410.05,486,406.05,482,410.05,478,401.05,482" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="370.5204" y="474.1571">transport</text><!--MD5=[5dec3acfd8f3e3e3c796fe4f98622533]
link p2p.PeerSet to p2p.peer--><path d="M873.17,482 C882.95,482 892.73,482 902.51,482 " fill="none" id="p2p.PeerSet-&gt;p2p.peer" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="907.63,482,898.63,478,902.63,482,898.63,486,907.63,482" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="20" x="879.8663" y="478.9053">list</text><!--MD5=[dd41cdacd55096906ddf8a32a5652db7]
@startuml
namespace p2p {
    class BaseReactor << (S,Aquamarine) >> {
        + Switch *Switch

    }
    interface IPeerSet  {
        + Has(key ID) bool
        + HasIP(ip net.IP) bool
        + Get(key ID) Peer
        + List() []Peer
        + Size() int

    }
    class MultiplexTransport << (S,Aquamarine) >> {
        - netAddr NetAddress
        - listener net.Listener
        - maxIncomingConnections int
        - acceptc <font color=blue>chan</font> accept
        - closec <font color=blue>chan</font> <font color=blue>struct</font>{}
        - conns ConnSet
        - connFilters []ConnFilterFunc
        - dialTimeout time.Duration
        - filterTimeout time.Duration
        - handshakeTimeout time.Duration
        - nodeInfo NodeInfo
        - nodeKey NodeKey
        - resolver IPResolver
        - mConfig conn.MConnConfig
 
    }
    interface Peer  {
        + FlushStop() 
        + ID() ID
        + RemoteIP() net.IP
        + RemoteAddr() net.Addr
        + IsOutbound() bool
        + IsPersistent() bool
        + CloseConn() error
        + NodeInfo() NodeInfo
        + Status() conn.ConnectionStatus
        + SocketAddr() *NetAddress
        + Send( byte,  []byte) bool
        + TrySend( byte,  []byte) bool
        + Set( string,  <font color=blue>interface</font>{}) 
        + Get( string) <font color=blue>interface</font>{}

    }
    class PeerSet << (S,Aquamarine) >> {
        - mtx sync.Mutex
        - lookup <font color=blue>map</font>[ID]*peerSetItem
        - list []Peer

        - hasIP(peerIP net.IP) bool

    }
    interface Reactor  {
        + SetSwitch( *Switch) 
        + GetChannels() []*conn.ChannelDescriptor
        + InitPeer(peer Peer) Peer
        + AddPeer(peer Peer) 
        + RemovePeer(peer Peer, reason <font color=blue>interface</font>{}) 
        + Receive(chID byte, peer Peer, msgBytes []byte) 

    }
    class Switch << (S,Aquamarine) >> {
        - config *config.P2PConfig
        - reactors <font color=blue>map</font>[string]Reactor
        - chDescs []*conn.ChannelDescriptor
        - reactorsByCh <font color=blue>map</font>[byte]Reactor
        - peers *PeerSet
        - dialing *cmap.CMap
        - reconnecting *cmap.CMap
        - nodeInfo NodeInfo
        - nodeKey *NodeKey
        - addrBook AddrBook
        - persistentPeersAddrs []*NetAddress
        - unconditionalPeerIDs <font color=blue>map</font>[ID]<font color=blue>struct</font>{}
        - transport Transport
        - filterTimeout time.Duration
        - peerFilters []PeerFilterFunc
        - rng *rand.Rand
        - metrics *Metrics

    }
    interface Transport  {
        + NetAddress() NetAddress
        + Accept( peerConfig) (Peer, error)
        + Dial( NetAddress,  peerConfig) (Peer, error)
        + Cleanup( Peer) 

    }
    class peer << (S,Aquamarine) >> {
        - mconn *conn.MConnection
        - nodeInfo NodeInfo
        - channels []byte
        - metrics *Metrics
        - metricsTicker *time.Ticker

        + Data *cmap.CMap

    }
    class peerConn << (S,Aquamarine) >> {
        - outbound bool
        - persistent bool
        - conn net.Conn
        - socketAddr *NetAddress
        - ip net.IP

        + ID() ID
        + RemoteIP() net.IP
        + CloseConn() 

    }
    interface transportLifecycle  {
        + Close() error
        + Listen( NetAddress) error

    }
}

namespace service {
    class BaseService << (S,Aquamarine) >> {
        - name string
        - started uint32
        - stopped uint32
        - quit <font color=blue>chan</font> <font color=blue>struct</font>{}
        - impl Service

        + Logger log.Logger
        
    }
    interface Service  {
        + Start() error
        + OnStart() error
        + Stop() error
        + OnStop() 
        + Reset() error
        + OnReset() error
        + IsRunning() bool
        + Quit() <font color=blue>chan</font> <font color=blue>struct</font>{}
        + String() string
        + SetLogger( log.Logger) 

    }
}

"service.Service" <|- - "service.BaseService"

"service.BaseService" *- - "p2p.BaseReactor"
"p2p.Reactor" <|-left "p2p.BaseReactor"

"p2p.peerConn" *- - "p2p.peer"
"service.BaseService" *- - "p2p.peer"


"p2p.Transport" <|- - "p2p.MultiplexTransport"
"p2p.transportLifecycle" <|- - "p2p.MultiplexTransport"
"p2p.IPeerSet" <|- - "p2p.PeerSet"

"p2p.Peer" <|- - "p2p.peer"

"service.BaseService" *-up- "p2p.Switch"
"p2p.BaseReactor" <.down. "reactors" "p2p.Switch"
"p2p.PeerSet" <.right "peers" "p2p.Switch"
"p2p.MultiplexTransport" <.left "transport" "p2p.Switch"
 "p2p.Switch" <.. "Switch" "p2p.BaseReactor"

"p2p.peer" <.right "list" "p2p.PeerSet"


@enduml

PlantUML version 1.2019.13(Wed Dec 11 01:18:29 CST 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 13.0.1+9
Operating System: Mac OS X
Default Encoding: UTF-8
Language: en
Country: CN
--></g></svg>