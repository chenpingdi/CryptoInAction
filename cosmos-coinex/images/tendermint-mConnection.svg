<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1186px" preserveAspectRatio="none" style="width:1025px;height:1186px;" version="1.1" viewBox="0 0 1025 1186" width="1025px" zoomAndPan="magnify"><defs><filter height="300%" id="f1l0ihd8pfygkp" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[fa03aa15696d8de1fc436cb9f6abb39b]
cluster p2p--><polygon fill="#FFFFFF" filter="url(#f1l0ihd8pfygkp)" points="22,24,55,24,62,46.4883,722,46.4883,722,1174,22,1174,22,24" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="22" x2="62" y1="46.4883" y2="46.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="26" y="39.5352">p2p</text><!--MD5=[52096ddeefb377140b702f047c765a55]
cluster conn--><polygon fill="#FFFFFF" filter="url(#f1l0ihd8pfygkp)" points="746,512,786,512,793,534.4883,976,534.4883,976,1148,746,1148,746,512" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="746" x2="793" y1="534.4883" y2="534.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="34" x="750" y="527.5352">conn</text><!--MD5=[c59a16d3fcadadefd9f8a8868b25a4e7]
cluster net--><polygon fill="#FFFFFF" filter="url(#f1l0ihd8pfygkp)" points="780,114.5,809,114.5,816,136.9883,874,136.9883,874,213.5,780,213.5,780,114.5" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="780" x2="816" y1="136.9883" y2="136.9883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="23" x="784" y="130.0352">net</text><!--MD5=[e3e52a252a583c20fdaae9f735fd57de]
class p2p.Peer--><rect fill="#FEFECE" filter="url(#f1l0ihd8pfygkp)" height="229.3711" id="p2p.Peer" style="stroke: #A80036; stroke-width: 1.5;" width="195" x="316.5" y="59"/><ellipse cx="396.75" cy="75" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M393.1777,71.2651 L393.1777,69.1069 L400.5571,69.1069 L400.5571,71.2651 L398.0918,71.2651 L398.0918,79.3418 L400.5571,79.3418 L400.5571,81.5 L393.1777,81.5 L393.1777,79.3418 L395.6431,79.3418 L395.6431,71.2651 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="26" x="417.25" y="79.5352">Peer</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="317.5" x2="510.5" y1="91" y2="91"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="317.5" x2="510.5" y1="99" y2="99"/><ellipse cx="327.5" cy="110" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="61" x="336.5" y="113.6348">FlushStop()</text><ellipse cx="327.5" cy="122.9551" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="33" x="336.5" y="126.5898">ID() ID</text><ellipse cx="327.5" cy="135.9102" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="89" x="336.5" y="139.5449">RemoteIP() net.IP</text><ellipse cx="327.5" cy="148.8652" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="125" x="336.5" y="152.5">RemoteAddr() net.Addr</text><ellipse cx="327.5" cy="161.8203" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="99" x="336.5" y="165.4551">IsOutbound() bool</text><ellipse cx="327.5" cy="174.7754" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="97" x="336.5" y="178.4102">IsPersistent() bool</text><ellipse cx="327.5" cy="187.7305" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="98" x="336.5" y="191.3652">CloseConn() error</text><ellipse cx="327.5" cy="200.6855" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="109" x="336.5" y="204.3203">NodeInfo() NodeInfo</text><ellipse cx="327.5" cy="213.6406" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="169" x="336.5" y="217.2754">Status() conn.ConnectionStatus</text><ellipse cx="327.5" cy="226.5957" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="141" x="336.5" y="230.2305">SocketAddr() *NetAddress</text><ellipse cx="327.5" cy="239.5508" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="127" x="336.5" y="243.1855">Send( byte,  []byte) bool</text><ellipse cx="327.5" cy="252.5059" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="145" x="336.5" y="256.1406">TrySend( byte,  []byte) bool</text><ellipse cx="327.5" cy="265.4609" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="58" x="336.5" y="269.0957">Set( string,</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="47" x="400.5" y="269.0957">interface</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="12" x="447.5" y="269.0957">{})</text><ellipse cx="327.5" cy="278.416" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="61" x="336.5" y="282.0508">Get( string)</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="47" x="400.5" y="282.0508">interface</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="8" x="447.5" y="282.0508">{}</text><!--MD5=[9fb5b8a8bddc32b7b1ff318042f2b338]
class p2p.IPeerSet--><rect fill="#FEFECE" filter="url(#f1l0ihd8pfygkp)" height="112.7754" id="p2p.IPeerSet" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="367" y="361"/><ellipse cx="406.3" cy="377" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M402.7277,373.2651 L402.7277,371.1069 L410.1071,371.1069 L410.1071,373.2651 L407.6418,373.2651 L407.6418,381.3418 L410.1071,381.3418 L410.1071,383.5 L402.7277,383.5 L402.7277,381.3418 L405.1931,381.3418 L405.1931,373.2651 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="46" x="425.7" y="381.5352">IPeerSet</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="368" x2="498" y1="393" y2="393"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="368" x2="498" y1="401" y2="401"/><ellipse cx="378" cy="412" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="87" x="387" y="415.6348">Has(key ID) bool</text><ellipse cx="378" cy="424.9551" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="106" x="387" y="428.5898">HasIP(ip net.IP) bool</text><ellipse cx="378" cy="437.9102" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="84" x="387" y="441.5449">Get(key ID) Peer</text><ellipse cx="378" cy="450.8652" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="61" x="387" y="454.5">List() []Peer</text><ellipse cx="378" cy="463.8203" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="46" x="387" y="467.4551">Size() int</text><!--MD5=[573edd832eea7a8264afd9f9040bf970]
class p2p.PeerSet--><rect fill="#FEFECE" filter="url(#f1l0ihd8pfygkp)" height="86.8652" id="p2p.PeerSet" style="stroke: #A80036; stroke-width: 1.5;" width="176" x="377" y="610"/><ellipse cx="439.25" cy="626" fill="#7FFFD4" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M438.4834,627.063 Q436.6323,626.3574 435.9766,625.5813 Q435.3208,624.8052 435.3208,623.4937 Q435.3208,621.8086 436.3999,620.8457 Q437.479,619.8828 439.3633,619.8828 Q440.2183,619.8828 441.0732,620.0779 Q441.9282,620.2729 442.7666,620.6548 L442.7666,623.0454 Q441.978,622.4893 441.1646,622.1987 Q440.3511,621.9082 439.5542,621.9082 Q438.666,621.9082 438.1929,622.2651 Q437.7197,622.6221 437.7197,623.2861 Q437.7197,623.8008 438.0642,624.137 Q438.4087,624.4731 439.5044,624.8799 L440.5586,625.2783 Q442.0527,625.8262 442.7583,626.731 Q443.4639,627.6357 443.4639,629.0137 Q443.4639,630.8896 442.3557,631.8152 Q441.2476,632.7407 439.0063,632.7407 Q438.085,632.7407 437.1594,632.5208 Q436.2339,632.3008 435.3706,631.8691 L435.3706,629.3374 Q436.3501,630.0347 437.2673,630.375 Q438.1846,630.7153 439.0811,630.7153 Q439.9858,630.7153 440.4839,630.3044 Q440.9819,629.8936 440.9819,629.1548 Q440.9819,628.5986 440.6499,628.1794 Q440.3179,627.7603 439.687,627.5195 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="43" x="459.75" y="630.5352">PeerSet</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="378" x2="552" y1="642" y2="642"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="385" y="650"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="85" x="397" y="656.6348">mtx sync.Mutex</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="385" y="662.9551"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="37" x="397" y="669.5898">lookup</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="23" x="437" y="669.5898">map</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="87" x="460" y="669.5898">[ID]*peerSetItem</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="385" y="675.9102"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="50" x="397" y="682.5449">list []Peer</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="378" x2="552" y1="688.8652" y2="688.8652"/><!--MD5=[18cff6f764bb194711d9f5dd93f9c958]
class p2p.Transport--><rect fill="#FEFECE" filter="url(#f1l0ihd8pfygkp)" height="99.8203" id="p2p.Transport" style="stroke: #A80036; stroke-width: 1.5;" width="257" x="114.5" y="1058"/><ellipse cx="210.25" cy="1074" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M206.6777,1070.2651 L206.6777,1068.1069 L214.0571,1068.1069 L214.0571,1070.2651 L211.5918,1070.2651 L211.5918,1078.3418 L214.0571,1078.3418 L214.0571,1080.5 L206.6777,1080.5 L206.6777,1078.3418 L209.1431,1078.3418 L209.1431,1070.2651 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="57" x="230.75" y="1078.5352">Transport</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="115.5" x2="370.5" y1="1090" y2="1090"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="115.5" x2="370.5" y1="1098" y2="1098"/><ellipse cx="125.5" cy="1109" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="137" x="134.5" y="1112.6348">NetAddress() NetAddress</text><ellipse cx="125.5" cy="1121.9551" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="176" x="134.5" y="1125.5898">Accept( peerConfig) (Peer, error)</text><ellipse cx="125.5" cy="1134.9102" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="231" x="134.5" y="1138.5449">Dial( NetAddress,  peerConfig) (Peer, error)</text><ellipse cx="125.5" cy="1147.8652" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="78" x="134.5" y="1151.5">Cleanup( Peer)</text><!--MD5=[6fef2d861d215382f2c7392a760d324d]
class p2p.peer--><rect fill="#FEFECE" filter="url(#f1l0ihd8pfygkp)" height="138.6855" id="p2p.peer" style="stroke: #A80036; stroke-width: 1.5;" width="172" x="534" y="348"/><ellipse cx="602.25" cy="364" fill="#7FFFD4" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M601.4834,365.063 Q599.6323,364.3574 598.9766,363.5813 Q598.3208,362.8052 598.3208,361.4937 Q598.3208,359.8086 599.3999,358.8457 Q600.479,357.8828 602.3633,357.8828 Q603.2183,357.8828 604.0732,358.0779 Q604.9282,358.2729 605.7666,358.6548 L605.7666,361.0454 Q604.978,360.4893 604.1646,360.1987 Q603.3511,359.9082 602.5542,359.9082 Q601.666,359.9082 601.1929,360.2651 Q600.7197,360.6221 600.7197,361.2861 Q600.7197,361.8008 601.0642,362.137 Q601.4087,362.4731 602.5044,362.8799 L603.5586,363.2783 Q605.0527,363.8262 605.7583,364.731 Q606.4639,365.6357 606.4639,367.0137 Q606.4639,368.8896 605.3557,369.8152 Q604.2476,370.7407 602.0063,370.7407 Q601.085,370.7407 600.1594,370.5208 Q599.2339,370.3008 598.3706,369.8691 L598.3706,367.3374 Q599.3501,368.0347 600.2673,368.375 Q601.1846,368.7153 602.0811,368.7153 Q602.9858,368.7153 603.4839,368.3044 Q603.9819,367.8936 603.9819,367.1548 Q603.9819,366.5986 603.6499,366.1794 Q603.3179,365.7603 602.687,365.5195 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="27" x="622.75" y="368.5352">peer</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="535" x2="705" y1="380" y2="380"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="542" y="388"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="146" x="554" y="394.6348">mconn *conn.MConnection</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="542" y="400.9551"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="100" x="554" y="407.5898">nodeInfo NodeInfo</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="542" y="413.9102"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="82" x="554" y="420.5449">channels []byte</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="542" y="426.8652"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="87" x="554" y="433.5">metrics *Metrics</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="542" y="439.8203"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="140" x="554" y="446.4551">metricsTicker *time.Ticker</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="557" y="459.4102"/><ellipse cx="545" cy="468.7305" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="94" x="554" y="472.3652">Data *cmap.CMap</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="535" x2="705" y1="478.6855" y2="478.6855"/><!--MD5=[f2ba958c56ea10e04681f7ec6c9a06ea]
class p2p.peerConn--><rect fill="#FEFECE" filter="url(#f1l0ihd8pfygkp)" height="112.7754" id="p2p.peerConn" style="stroke: #A80036; stroke-width: 1.5;" width="159" x="546.5" y="117"/><ellipse cx="593.75" cy="133" fill="#7FFFD4" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M592.9834,134.063 Q591.1323,133.3574 590.4766,132.5813 Q589.8208,131.8052 589.8208,130.4937 Q589.8208,128.8086 590.8999,127.8457 Q591.979,126.8828 593.8633,126.8828 Q594.7183,126.8828 595.5732,127.0779 Q596.4282,127.2729 597.2666,127.6548 L597.2666,130.0454 Q596.478,129.4893 595.6646,129.1987 Q594.8511,128.9082 594.0542,128.9082 Q593.166,128.9082 592.6929,129.2651 Q592.2197,129.6221 592.2197,130.2861 Q592.2197,130.8008 592.5642,131.137 Q592.9087,131.4731 594.0044,131.8799 L595.0586,132.2783 Q596.5527,132.8262 597.2583,133.731 Q597.9639,134.6357 597.9639,136.0137 Q597.9639,137.8896 596.8557,138.8152 Q595.7476,139.7407 593.5063,139.7407 Q592.585,139.7407 591.6594,139.5208 Q590.7339,139.3008 589.8706,138.8691 L589.8706,136.3374 Q590.8501,137.0347 591.7673,137.375 Q592.6846,137.7153 593.5811,137.7153 Q594.4858,137.7153 594.9839,137.3044 Q595.4819,136.8936 595.4819,136.1548 Q595.4819,135.5986 595.1499,135.1794 Q594.8179,134.7603 594.187,134.5195 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="56" x="614.25" y="137.5352">peerConn</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="547.5" x2="704.5" y1="149" y2="149"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="554.5" y="157"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="80" x="566.5" y="163.6348">outbound bool</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="554.5" y="169.9551"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="81" x="566.5" y="176.5898">persistent bool</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="554.5" y="182.9102"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="79" x="566.5" y="189.5449">conn net.Conn</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="554.5" y="195.8652"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="133" x="566.5" y="202.5">socketAddr *NetAddress</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="554.5" y="208.8203"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="42" x="566.5" y="215.4551">ip net.IP</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="547.5" x2="704.5" y1="221.7754" y2="221.7754"/><!--MD5=[c22516aed28ee4c58d2db0be50dce8ef]
class p2p.transportLifecycle--><rect fill="#FEFECE" filter="url(#f1l0ihd8pfygkp)" height="73.9102" id="p2p.transportLifecycle" style="stroke: #A80036; stroke-width: 1.5;" width="163" x="406.5" y="1071"/><ellipse cx="435" cy="1087" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M431.4277,1083.2651 L431.4277,1081.1069 L438.8071,1081.1069 L438.8071,1083.2651 L436.3418,1083.2651 L436.3418,1091.3418 L438.8071,1091.3418 L438.8071,1093.5 L431.4277,1093.5 L431.4277,1091.3418 L433.8931,1091.3418 L433.8931,1083.2651 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="101" x="452" y="1091.5352">transportLifecycle</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="407.5" x2="568.5" y1="1103" y2="1103"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="407.5" x2="568.5" y1="1111" y2="1111"/><ellipse cx="417.5" cy="1122" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="69" x="426.5" y="1125.6348">Close() error</text><ellipse cx="417.5" cy="1134.9551" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="137" x="426.5" y="1138.5898">Listen( NetAddress) error</text><!--MD5=[48cb090cdb247cbc8abf3a8cb8b11423]
class p2p.ConnSet--><rect fill="#FEFECE" filter="url(#f1l0ihd8pfygkp)" height="112.7754" id="p2p.ConnSet" style="stroke: #A80036; stroke-width: 1.5;" width="153" x="38.5" y="361"/><ellipse cx="87.75" cy="377" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M84.1777,373.2651 L84.1777,371.1069 L91.5571,371.1069 L91.5571,373.2651 L89.0918,373.2651 L89.0918,381.3418 L91.5571,381.3418 L91.5571,383.5 L84.1777,383.5 L84.1777,381.3418 L86.6431,381.3418 L86.6431,373.2651 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="46" x="108.25" y="381.5352">ConnSet</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="39.5" x2="190.5" y1="393" y2="393"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="39.5" x2="190.5" y1="401" y2="401"/><ellipse cx="49.5" cy="412" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="107" x="58.5" y="415.6348">Has( net.Conn) bool</text><ellipse cx="49.5" cy="424.9551" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="96" x="58.5" y="428.5898">HasIP( net.IP) bool</text><ellipse cx="49.5" cy="437.9102" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="122" x="58.5" y="441.5449">Set( net.Conn,  []net.IP)</text><ellipse cx="49.5" cy="450.8652" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="102" x="58.5" y="454.5">Remove( net.Conn)</text><ellipse cx="49.5" cy="463.8203" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="127" x="58.5" y="467.4551">RemoveAddr( net.Addr)</text><!--MD5=[6b82c73672e41dc858a5b85c68dd7260]
class p2p.connSet--><rect fill="#FEFECE" filter="url(#f1l0ihd8pfygkp)" height="60.9551" id="p2p.connSet" style="stroke: #A80036; stroke-width: 1.5;" width="191" x="150.5" y="623"/><ellipse cx="219.75" cy="639" fill="#7FFFD4" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M218.9834,640.063 Q217.1323,639.3574 216.4766,638.5813 Q215.8208,637.8052 215.8208,636.4937 Q215.8208,634.8086 216.8999,633.8457 Q217.979,632.8828 219.8633,632.8828 Q220.7183,632.8828 221.5732,633.0779 Q222.4282,633.2729 223.2666,633.6548 L223.2666,636.0454 Q222.478,635.4893 221.6646,635.1987 Q220.8511,634.9082 220.0542,634.9082 Q219.166,634.9082 218.6929,635.2651 Q218.2197,635.6221 218.2197,636.2861 Q218.2197,636.8008 218.5642,637.137 Q218.9087,637.4731 220.0044,637.8799 L221.0586,638.2783 Q222.5527,638.8262 223.2583,639.731 Q223.9639,640.6357 223.9639,642.0137 Q223.9639,643.8896 222.8557,644.8152 Q221.7476,645.7407 219.5063,645.7407 Q218.585,645.7407 217.6594,645.5208 Q216.7339,645.3008 215.8706,644.8691 L215.8706,642.3374 Q216.8501,643.0347 217.7673,643.375 Q218.6846,643.7153 219.5811,643.7153 Q220.4858,643.7153 220.9839,643.3044 Q221.4819,642.8936 221.4819,642.1548 Q221.4819,641.5986 221.1499,641.1794 Q220.8179,640.7603 220.187,640.5195 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="44" x="240.25" y="643.5352">connSet</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="151.5" x2="340.5" y1="655" y2="655"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="158.5" y="663"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="33" x="170.5" y="669.6348">conns</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="23" x="206.5" y="669.6348">map</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="106" x="229.5" y="669.6348">[string]connSetItem</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="151.5" x2="340.5" y1="675.9551" y2="675.9551"/><!--MD5=[22e0396bef899c84f2dfb543afea9b77]
class p2p.connSetItem--><rect fill="#FEFECE" filter="url(#f1l0ihd8pfygkp)" height="73.9102" id="p2p.connSetItem" style="stroke: #A80036; stroke-width: 1.5;" width="105" x="226.5" y="380.5"/><ellipse cx="243.3" cy="396.5" fill="#7FFFD4" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M242.5334,397.563 Q240.6823,396.8574 240.0266,396.0813 Q239.3708,395.3052 239.3708,393.9937 Q239.3708,392.3086 240.4499,391.3457 Q241.529,390.3828 243.4133,390.3828 Q244.2683,390.3828 245.1232,390.5779 Q245.9782,390.7729 246.8166,391.1548 L246.8166,393.5454 Q246.028,392.9893 245.2146,392.6987 Q244.4011,392.4082 243.6042,392.4082 Q242.716,392.4082 242.2429,392.7651 Q241.7697,393.1221 241.7697,393.7861 Q241.7697,394.3008 242.1142,394.637 Q242.4587,394.9731 243.5544,395.3799 L244.6086,395.7783 Q246.1027,396.3262 246.8083,397.231 Q247.5139,398.1357 247.5139,399.5137 Q247.5139,401.3896 246.4057,402.3152 Q245.2976,403.2407 243.0563,403.2407 Q242.135,403.2407 241.2094,403.0208 Q240.2839,402.8008 239.4206,402.3691 L239.4206,399.8374 Q240.4001,400.5347 241.3173,400.875 Q242.2346,401.2153 243.1311,401.2153 Q244.0358,401.2153 244.5339,400.8044 Q245.0319,400.3936 245.0319,399.6548 Q245.0319,399.0986 244.6999,398.6794 Q244.3679,398.2603 243.737,398.0195 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="69" x="257.7" y="401.0352">connSetItem</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="227.5" x2="330.5" y1="412.5" y2="412.5"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="234.5" y="420.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="79" x="246.5" y="427.1348">conn net.Conn</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="234.5" y="433.4551"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="56" x="246.5" y="440.0898">ips []net.IP</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="227.5" x2="330.5" y1="446.4102" y2="446.4102"/><!--MD5=[53e5f75d9eb4a4b76da8301e97156229]
class p2p.MultiplexTransport--><rect fill="#FEFECE" filter="url(#f1l0ihd8pfygkp)" height="48" id="p2p.MultiplexTransport" style="stroke: #A80036; stroke-width: 1.5;" width="141" x="195.5" y="885"/><ellipse cx="210.5" cy="901" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M212.9731,907.1431 Q212.3921,907.4419 211.7529,907.5913 Q211.1138,907.7407 210.4082,907.7407 Q207.9014,907.7407 206.5815,906.0889 Q205.2617,904.437 205.2617,901.3159 Q205.2617,898.1865 206.5815,896.5347 Q207.9014,894.8828 210.4082,894.8828 Q211.1138,894.8828 211.7612,895.0322 Q212.4087,895.1816 212.9731,895.4805 L212.9731,898.2031 Q212.3423,897.6221 211.7488,897.3523 Q211.1553,897.0825 210.5244,897.0825 Q209.1797,897.0825 208.4949,898.1492 Q207.8101,899.2158 207.8101,901.3159 Q207.8101,903.4077 208.4949,904.4744 Q209.1797,905.541 210.5244,905.541 Q211.1553,905.541 211.7488,905.2712 Q212.3423,905.0015 212.9731,904.4204 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="109" x="224.5" y="905.5352">MultiplexTransport</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="196.5" x2="335.5" y1="917" y2="917"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="196.5" x2="335.5" y1="925" y2="925"/><!--MD5=[311699931f27d41b8a110d6bfb3b1517]
class p2p.BaseReactor--><rect fill="#FEFECE" filter="url(#f1l0ihd8pfygkp)" height="48" id="p2p.BaseReactor" style="stroke: #A80036; stroke-width: 1.5;" width="103" x="513.5" y="885"/><ellipse cx="528.5" cy="901" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M530.9731,907.1431 Q530.3921,907.4419 529.7529,907.5913 Q529.1138,907.7407 528.4082,907.7407 Q525.9014,907.7407 524.5815,906.0889 Q523.2617,904.437 523.2617,901.3159 Q523.2617,898.1865 524.5815,896.5347 Q525.9014,894.8828 528.4082,894.8828 Q529.1138,894.8828 529.7612,895.0322 Q530.4087,895.1816 530.9731,895.4805 L530.9731,898.2031 Q530.3423,897.6221 529.7488,897.3523 Q529.1553,897.0825 528.5244,897.0825 Q527.1797,897.0825 526.4949,898.1492 Q525.8101,899.2158 525.8101,901.3159 Q525.8101,903.4077 526.4949,904.4744 Q527.1797,905.541 528.5244,905.541 Q529.1553,905.541 529.7488,905.2712 Q530.3423,905.0015 530.9731,904.4204 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="71" x="542.5" y="905.5352">BaseReactor</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="514.5" x2="615.5" y1="917" y2="917"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="514.5" x2="615.5" y1="925" y2="925"/><!--MD5=[b34240524190d792e7d8883f18bd4dc7]
class p2p.Switch--><rect fill="#FEFECE" filter="url(#f1l0ihd8pfygkp)" height="48" id="p2p.Switch" style="stroke: #A80036; stroke-width: 1.5;" width="67" x="411.5" y="885"/><ellipse cx="426.5" cy="901" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M428.9731,907.1431 Q428.3921,907.4419 427.7529,907.5913 Q427.1138,907.7407 426.4082,907.7407 Q423.9014,907.7407 422.5815,906.0889 Q421.2617,904.437 421.2617,901.3159 Q421.2617,898.1865 422.5815,896.5347 Q423.9014,894.8828 426.4082,894.8828 Q427.1138,894.8828 427.7612,895.0322 Q428.4087,895.1816 428.9731,895.4805 L428.9731,898.2031 Q428.3423,897.6221 427.7488,897.3523 Q427.1553,897.0825 426.5244,897.0825 Q425.1797,897.0825 424.4949,898.1492 Q423.8101,899.2158 423.8101,901.3159 Q423.8101,903.4077 424.4949,904.4744 Q425.1797,905.541 426.5244,905.541 Q427.1553,905.541 427.7488,905.2712 Q428.3423,905.0015 428.9731,904.4204 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="35" x="440.5" y="905.5352">Switch</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="412.5" x2="477.5" y1="917" y2="917"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="412.5" x2="477.5" y1="925" y2="925"/><!--MD5=[2fee26f1c5de6d1a907f79bec55ff11f]
class conn.Channel--><rect fill="#FEFECE" filter="url(#f1l0ihd8pfygkp)" height="177.5508" id="conn.Channel" style="stroke: #A80036; stroke-width: 1.5;" width="184" x="772" y="820"/><ellipse cx="836.75" cy="836" fill="#7FFFD4" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M835.9834,837.063 Q834.1323,836.3574 833.4766,835.5813 Q832.8208,834.8052 832.8208,833.4937 Q832.8208,831.8086 833.8999,830.8457 Q834.979,829.8828 836.8633,829.8828 Q837.7183,829.8828 838.5732,830.0779 Q839.4282,830.2729 840.2666,830.6548 L840.2666,833.0454 Q839.478,832.4893 838.6646,832.1987 Q837.8511,831.9082 837.0542,831.9082 Q836.166,831.9082 835.6929,832.2651 Q835.2197,832.6221 835.2197,833.2861 Q835.2197,833.8008 835.5642,834.137 Q835.9087,834.4731 837.0044,834.8799 L838.0586,835.2783 Q839.5527,835.8262 840.2583,836.731 Q840.9639,837.6357 840.9639,839.0137 Q840.9639,840.8896 839.8557,841.8152 Q838.7476,842.7407 836.5063,842.7407 Q835.585,842.7407 834.6594,842.5208 Q833.7339,842.3008 832.8706,841.8691 L832.8706,839.3374 Q833.8501,840.0347 834.7673,840.375 Q835.6846,840.7153 836.5811,840.7153 Q837.4858,840.7153 837.9839,840.3044 Q838.4819,839.8936 838.4819,839.1548 Q838.4819,838.5986 838.1499,838.1794 Q837.8179,837.7603 837.187,837.5195 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="46" x="857.25" y="840.5352">Channel</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="773" x2="955" y1="852" y2="852"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="780" y="860"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="106" x="792" y="866.6348">conn *MConnection</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="780" y="872.9551"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="129" x="792" y="879.5898">desc ChannelDescriptor</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="780" y="885.9102"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="61" x="792" y="892.5449">sendQueue</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="26" x="856" y="892.5449">chan</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="31" x="885" y="892.5449">[]byte</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="780" y="898.8652"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="113" x="792" y="905.5">sendQueueSize int32</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="780" y="911.8203"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="74" x="792" y="918.4551">recving []byte</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="780" y="924.7754"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="77" x="792" y="931.4102">sending []byte</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="780" y="937.7305"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="97" x="792" y="944.3652">recentlySent int64</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="780" y="950.6855"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="158" x="792" y="957.3203">maxPacketMsgPayloadSize int</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="795" y="970.2754"/><ellipse cx="783" cy="979.5957" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="99" x="792" y="983.2305">Logger log.Logger</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="773" x2="955" y1="989.5508" y2="989.5508"/><!--MD5=[f5a56f142683e57a747013f71260e772]
class conn.ChannelDescriptor--><rect fill="#FEFECE" filter="url(#f1l0ihd8pfygkp)" height="48" id="conn.ChannelDescriptor" style="stroke: #A80036; stroke-width: 1.5;" width="138" x="795" y="1084"/><ellipse cx="810" cy="1100" fill="#7FFFD4" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M809.2334,1101.063 Q807.3823,1100.3574 806.7266,1099.5813 Q806.0708,1098.8052 806.0708,1097.4937 Q806.0708,1095.8086 807.1499,1094.8457 Q808.229,1093.8828 810.1133,1093.8828 Q810.9683,1093.8828 811.8232,1094.0779 Q812.6782,1094.2729 813.5166,1094.6548 L813.5166,1097.0454 Q812.728,1096.4893 811.9146,1096.1987 Q811.1011,1095.9082 810.3042,1095.9082 Q809.416,1095.9082 808.9429,1096.2651 Q808.4697,1096.6221 808.4697,1097.2861 Q808.4697,1097.8008 808.8142,1098.137 Q809.1587,1098.4731 810.2544,1098.8799 L811.3086,1099.2783 Q812.8027,1099.8262 813.5083,1100.731 Q814.2139,1101.6357 814.2139,1103.0137 Q814.2139,1104.8896 813.1057,1105.8152 Q811.9976,1106.7407 809.7563,1106.7407 Q808.835,1106.7407 807.9094,1106.5208 Q806.9839,1106.3008 806.1206,1105.8691 L806.1206,1103.3374 Q807.1001,1104.0347 808.0173,1104.375 Q808.9346,1104.7153 809.8311,1104.7153 Q810.7358,1104.7153 811.2339,1104.3044 Q811.7319,1103.8936 811.7319,1103.1548 Q811.7319,1102.5986 811.3999,1102.1794 Q811.0679,1101.7603 810.437,1101.5195 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="106" x="824" y="1104.5352">ChannelDescriptor</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="796" x2="932" y1="1116" y2="1116"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="796" x2="932" y1="1124" y2="1124"/><!--MD5=[587ec7518afc6b0bd734d507e80c24a2]
class conn.MConnection--><rect fill="#FEFECE" filter="url(#f1l0ihd8pfygkp)" height="213.4609" id="conn.MConnection" style="stroke: #A80036; stroke-width: 1.5;" width="197" x="762.5" y="547"/><ellipse cx="820.25" cy="563" fill="#7FFFD4" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M819.4834,564.063 Q817.6323,563.3574 816.9766,562.5813 Q816.3208,561.8052 816.3208,560.4937 Q816.3208,558.8086 817.3999,557.8457 Q818.479,556.8828 820.3633,556.8828 Q821.2183,556.8828 822.0732,557.0779 Q822.9282,557.2729 823.7666,557.6548 L823.7666,560.0454 Q822.978,559.4893 822.1646,559.1987 Q821.3511,558.9082 820.5542,558.9082 Q819.666,558.9082 819.1929,559.2651 Q818.7197,559.6221 818.7197,560.2861 Q818.7197,560.8008 819.0642,561.137 Q819.4087,561.4731 820.5044,561.8799 L821.5586,562.2783 Q823.0527,562.8262 823.7583,563.731 Q824.4639,564.6357 824.4639,566.0137 Q824.4639,567.8896 823.3557,568.8152 Q822.2476,569.7407 820.0063,569.7407 Q819.085,569.7407 818.1594,569.5208 Q817.2339,569.3008 816.3706,568.8691 L816.3706,566.3374 Q817.3501,567.0347 818.2673,567.375 Q819.1846,567.7153 820.0811,567.7153 Q820.9858,567.7153 821.4839,567.3044 Q821.9819,566.8936 821.9819,566.1548 Q821.9819,565.5986 821.6499,565.1794 Q821.3179,564.7603 820.687,564.5195 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="73" x="840.75" y="567.5352">MConnection</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="763.5" x2="958.5" y1="579" y2="579"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="770.5" y="587"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="79" x="782.5" y="593.6348">conn net.Conn</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="770.5" y="599.9551"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="160" x="782.5" y="606.5898">bufConnReader *bufio.Reader</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="770.5" y="612.9102"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="150" x="782.5" y="619.5449">bufConnWriter *bufio.Writer</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="770.5" y="625.8652"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="164" x="782.5" y="632.5">sendMonitor *flowrate.Monitor</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="770.5" y="638.8203"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="161" x="782.5" y="645.4551">recvMonitor *flowrate.Monitor</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="770.5" y="651.7754"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="26" x="782.5" y="658.4102">send</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="26" x="811.5" y="658.4102">chan</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="840.5" y="658.4102"/><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="32" x="840.5" y="658.4102">struct</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="8" x="872.5" y="658.4102">{}</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="770.5" y="664.7305"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="28" x="782.5" y="671.3652">pong</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="26" x="813.5" y="671.3652">chan</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="842.5" y="671.3652"/><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="32" x="842.5" y="671.3652">struct</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="8" x="874.5" y="671.3652">{}</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="770.5" y="677.6855"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="108" x="782.5" y="684.3203">channels []*Channel</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="770.5" y="690.6406"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="65" x="782.5" y="697.2754">channelsIdx</text><text fill="#0000FF" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="23" x="850.5" y="697.2754">map</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="80" x="873.5" y="697.2754">[byte]*Channel</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="770.5" y="703.5957"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="136" x="782.5" y="710.2305">onReceive receiveCbFunc</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="770.5" y="716.5508"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,2.0;" x1="782.5" x2="792.5" y1="718.0508" y2="718.0508"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="0" x="785.5" y="734.1855"/><ellipse cx="773.5" cy="743.5059" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="123" x="782.5" y="747.1406">_maxPacketMsgSize int</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="763.5" x2="958.5" y1="752.4609" y2="752.4609"/><!--MD5=[5cf6fe4c3529dc3e42c3fd90ef76bcd8]
class net.Conn--><rect fill="#FEFECE" filter="url(#f1l0ihd8pfygkp)" height="48" id="net.Conn" style="stroke: #A80036; stroke-width: 1.5;" width="61" x="796.5" y="149.5"/><ellipse cx="811.5" cy="165.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M813.9731,171.6431 Q813.3921,171.9419 812.7529,172.0913 Q812.1138,172.2407 811.4082,172.2407 Q808.9014,172.2407 807.5815,170.5889 Q806.2617,168.937 806.2617,165.8159 Q806.2617,162.6865 807.5815,161.0347 Q808.9014,159.3828 811.4082,159.3828 Q812.1138,159.3828 812.7612,159.5322 Q813.4087,159.6816 813.9731,159.9805 L813.9731,162.7031 Q813.3423,162.1221 812.7488,161.8523 Q812.1553,161.5825 811.5244,161.5825 Q810.1797,161.5825 809.4949,162.6492 Q808.8101,163.7158 808.8101,165.8159 Q808.8101,167.9077 809.4949,168.9744 Q810.1797,170.041 811.5244,170.041 Q812.1553,170.041 812.7488,169.7712 Q813.3423,169.5015 813.9731,168.9204 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="29" x="825.5" y="170.0352">Conn</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="797.5" x2="856.5" y1="181.5" y2="181.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="797.5" x2="856.5" y1="189.5" y2="189.5"/><!--MD5=[30ba27f9c8e0fd4ca7be887af7494379]
link p2p.peer to conn.MConnection--><path d="M703.67,487.21 C709.95,492.8 716.13,498.44 722,504 C735.01,516.32 748.32,529.58 761.3,542.94 " fill="none" id="p2p.peer-&gt;conn.MConnection" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="764.96,546.71,761.5548,537.4685,761.4748,543.1248,755.8185,543.0448,764.96,546.71" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="666.5956" y="507.1672">mconn</text><!--MD5=[96038fde786da2a8901411ad44019f61]
link conn.MConnection to conn.Channel--><path d="M862.25,760.17 C862.46,778.15 862.68,796.7 862.89,814.34 " fill="none" id="conn.MConnection-&gt;conn.Channel" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="862.96,819.78,866.831,810.7238,862.8886,814.7805,858.8318,810.8381,862.96,819.78" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="804.2855" y="781.1172">channels</text><!--MD5=[f4b485c9212d25e6426632cac731cb25]
link conn.Channel to conn.ChannelDescriptor--><path d="M864,998.13 C864,1027.22 864,1057.52 864,1078.75 " fill="none" id="conn.Channel-&gt;conn.ChannelDescriptor" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="864,1083.95,868,1074.95,864,1078.95,860,1074.95,864,1083.95" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="29" x="833.8898" y="1018.1257">desc</text><!--MD5=[1fb738791e73d065ffc593a5e7b5b019]
reverse link net.Conn to conn.MConnection--><path d="M829.02,202.89 C833.72,269 845.6,436.02 853.48,546.82 " fill="none" id="net.Conn&lt;-conn.MConnection" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="828.64,197.55,825.2933,206.8128,828.9973,202.5372,833.2728,206.2412,828.64,197.55" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="31" x="820.8614" y="536.3548">conn</text><!--MD5=[eb233170bcb015c61ecd52b7091685bd]
reverse link net.Conn to conn.Channel--><path d="M844.56,202.11 C878.3,257 951.15,384.81 977,504 C1001.12,615.19 1013.44,652.22 977,760 C969.91,780.98 958.52,801.33 945.64,819.88 " fill="none" id="net.Conn&lt;-conn.Channel" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="841.81,197.66,843.1348,207.4193,844.4369,201.9144,849.9418,203.2164,841.81,197.66" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="31" x="920.3239" y="809.1777">conn</text><!--MD5=[eb9ce36c39a54a5ea7008fd0f467310c]
reverse link net.Conn to p2p.connSetItem--><path d="M809.57,202.12 C791.2,228.71 759.73,267.78 722,288 C574,367.3 498.93,272.4 349,348 C333.51,355.81 319.26,368.27 307.71,380.44 " fill="none" id="net.Conn&lt;-p2p.connSetItem" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="812.4,197.96,804.0256,203.1436,809.5838,202.0914,810.6359,207.6496,812.4,197.96" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="31" x="279.1456" y="369.8295">conn</text><!--MD5=[72ae5fa457541c07a4e8d5ad283b7652]
reverse link net.Conn to p2p.peerConn--><path d="M790.9,173.5 C762.5,173.5 734.09,173.5 705.69,173.5 " fill="none" id="net.Conn&lt;-p2p.peerConn" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="796.2,173.5,787.2,169.5,791.2,173.5,787.2,177.5,796.2,173.5" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="31" x="713.5729" y="170.4694">conn</text><!--MD5=[85cc07f7a9009753228026d51a89f1a9]
reverse link p2p.connSetItem to p2p.connSet--><path d="M273.21,459.54 C266.63,506.22 256.04,581.32 250.2,622.72 " fill="none" id="p2p.connSetItem&lt;-p2p.connSet" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="273.92,454.55,268.7009,462.9023,273.2209,459.5009,276.6223,464.0209,273.92,454.55" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="31" x="216.8694" y="612.4298">conn</text><!--MD5=[1645e38de450ed825023b7de5808ac1b]
reverse link p2p.connSet to p2p.MultiplexTransport--><path d="M248.75,689.33 C252.9,741.96 260.66,840.34 264.18,884.95 " fill="none" id="p2p.connSet&lt;-p2p.MultiplexTransport" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="248.33,684.08,245.0626,693.3711,248.7299,689.064,253.0369,692.7313,248.33,684.08" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="38" x="220.5846" y="874.081">conns</text><!--MD5=[bd84bf6db8ad61ce24504e58d3a584d4]
reverse link p2p.ConnSet to p2p.connSet--><path d="M156.1,491.91 C180.87,536.16 211.08,590.12 229.41,622.87 " fill="none" id="p2p.ConnSet&lt;-p2p.connSet" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="149.87,495.12,146.21,474.25,162.09,488.28,149.87,495.12" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[b9fbf2a7effaeaefa17c476384a1dba2]
reverse link p2p.peerConn to p2p.peer--><path d="M624.3,243.17 C623.48,275.94 622.52,315.06 621.7,347.83 " fill="none" id="p2p.peerConn&lt;-p2p.peer" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="624.62,230.02,620.4697,235.917,624.3168,242.0162,628.4671,236.1192,624.62,230.02" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[00dc60a3db96d974d6f09cddb1e33a9c]
link p2p.MultiplexTransport to p2p.Transport--><path d="M263.27,933.37 C260.28,958.97 255.35,1001.22 251.1,1037.64 " fill="none" id="p2p.MultiplexTransport-&gt;p2p.Transport" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="258.03,1038.62,248.76,1057.68,244.13,1037,258.03,1038.62" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[2c9f51bc795756116b03063064369ede]
link p2p.MultiplexTransport to p2p.transportLifecycle--><path d="M292.34,933.37 C326.65,963.82 387.55,1017.86 432.31,1057.59 " fill="none" id="p2p.MultiplexTransport-&gt;p2p.transportLifecycle" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="437.09,1052.47,447.41,1070.98,427.8,1062.94,437.09,1052.47" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[050d08726fdf1574cedda3f8be396e30]
reverse link p2p.IPeerSet to p2p.PeerSet--><path d="M443.35,494.17 C448.6,532.55 454.78,577.73 459.19,609.99 " fill="none" id="p2p.IPeerSet&lt;-p2p.PeerSet" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="436.4,495.02,440.62,474.25,450.27,493.12,436.4,495.02" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[a88ba8938669b8d1f443f70d77216d8b]
reverse link p2p.Peer to p2p.peer--><path d="M523.7,303.37 C536.71,318.65 549.58,333.77 561.47,347.74 " fill="none" id="p2p.Peer&lt;-p2p.peer" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="518.3,307.83,510.67,288.06,528.96,298.75,518.3,307.83" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[2fd7e9af1c7b4cb47549e455308b7e6b]
reverse link p2p.BaseReactor to p2p.Switch--><path d="M508.3,926.95 C498.45,927.27 488.6,926.14 478.75,923.55 " fill="none" id="p2p.BaseReactor&lt;-p2p.Switch" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="513.45,926.64,504.2359,923.1615,508.4582,926.9261,504.6936,931.1484,513.45,926.64" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="464.7662" y="953.566">reactors</text><!--MD5=[b14611813044e641dc988996b3ed6edd]
reverse link p2p.Switch to p2p.BaseReactor--><path d="M483.63,893.28 C493.57,891.16 503.51,890.52 513.45,891.36 " fill="none" id="p2p.Switch&lt;-p2p.BaseReactor" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="478.75,894.45,488.4308,896.2618,483.6146,893.2945,486.5819,888.4783,478.75,894.45" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="41" x="482.1" y="874.0693">Switch</text><!--MD5=[1ab1a2ae8783d41482bcd0d71e5c3297]
reverse link p2p.PeerSet to p2p.Switch--><path d="M461.22,702.39 C456.92,756.91 450.07,843.73 446.82,884.89 " fill="none" id="p2p.PeerSet&lt;-p2p.Switch" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="461.63,697.22,456.9231,705.8713,461.2301,702.204,464.8974,706.5111,461.63,697.22" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="34" x="408.9301" y="874.3981">peers</text><!--MD5=[9fe161fb271e8b8d4eeb24ae21c077f8]
reverse link p2p.MultiplexTransport to p2p.Switch--><path d="M341.86,909 C364.95,909 388.04,909 411.13,909 " fill="none" id="p2p.MultiplexTransport&lt;-p2p.Switch" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="336.62,909,345.62,913,341.62,909,345.62,905,336.62,909" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="345.4677" y="905.6732">transport</text><!--MD5=[2c56d9259f5f2a3bf68e766ea18eda88]
reverse link p2p.peer to p2p.PeerSet--><path d="M571.75,491.34 C546.03,530.18 515.26,576.62 493.38,609.65 " fill="none" id="p2p.peer&lt;-p2p.PeerSet" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="574.54,487.13,566.2404,492.4326,571.783,491.3012,572.9144,496.8438,574.54,487.13" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="20" x="476.1944" y="599.3895">list</text><!--MD5=[c077d451b109c8be4c3642aa977938df]
@startuml

namespace p2p{
    interface Peer  {
        + FlushStop() 
        + ID() ID
        + RemoteIP() net.IP
        + RemoteAddr() net.Addr
        + IsOutbound() bool
        + IsPersistent() bool
        + CloseConn() error
        + NodeInfo() NodeInfo
        + Status() conn.ConnectionStatus
        + SocketAddr() *NetAddress
        + Send( byte,  []byte) bool
        + TrySend( byte,  []byte) bool
        + Set( string,  <font color=blue>interface</font>{}) 
        + Get( string) <font color=blue>interface</font>{}

    }
    interface IPeerSet  {
        + Has(key ID) bool
        + HasIP(ip net.IP) bool
        + Get(key ID) Peer
        + List() []Peer
        + Size() int

    }

    class PeerSet << (S,Aquamarine) >> {
        - mtx sync.Mutex
        - lookup <font color=blue>map</font>[ID]*peerSetItem
        - list []Peer

    }

    interface Transport  {
        + NetAddress() NetAddress
        + Accept( peerConfig) (Peer, error)
        + Dial( NetAddress,  peerConfig) (Peer, error)
        + Cleanup( Peer)

    }
    class peer << (S,Aquamarine) >> {
        - mconn *conn.MConnection
        - nodeInfo NodeInfo
        - channels []byte
        - metrics *Metrics
        - metricsTicker *time.Ticker

        + Data *cmap.CMap

    }
    class peerConn << (S,Aquamarine) >> {
        - outbound bool
        - persistent bool
        - conn net.Conn
        - socketAddr *NetAddress
        - ip net.IP

    }
    interface transportLifecycle  {
        + Close() error
        + Listen( NetAddress) error

    }
    interface ConnSet  {
        + Has( net.Conn) bool
        + HasIP( net.IP) bool
        + Set( net.Conn,  []net.IP) 
        + Remove( net.Conn) 
        + RemoveAddr( net.Addr) 

    }
    class connSet << (S,Aquamarine) >> {
        - conns <font color=blue>map</font>[string]connSetItem
    }
    class connSetItem << (S,Aquamarine) >> {
        - conn net.Conn
        - ips []net.IP

    }

}

namespace conn {
    class Channel << (S,Aquamarine) >> {
        - conn *MConnection
        - desc ChannelDescriptor
        - sendQueue <font color=blue>chan</font> []byte
        - sendQueueSize int32
        - recving []byte
        - sending []byte
        - recentlySent int64
        - maxPacketMsgPayloadSize int

        + Logger log.Logger

    }
    class ChannelDescriptor << (S,Aquamarine) >> {

    }
    class MConnection << (S,Aquamarine) >> {
        - conn net.Conn
        - bufConnReader *bufio.Reader
        - bufConnWriter *bufio.Writer
        - sendMonitor *flowrate.Monitor
        - recvMonitor *flowrate.Monitor
        - send <font color=blue>chan</font> <font color=blue>struct</font>{}
        - pong <font color=blue>chan</font> <font color=blue>struct</font>{}
        - channels []*Channel
        - channelsIdx <font color=blue>map</font>[byte]*Channel
        - onReceive receiveCbFunc
        - ....

        + _maxPacketMsgSize int

    }
}
"conn.MConnection" <.down. "mconn" "p2p.peer"
"conn.Channel" <.down. "channels" "conn.MConnection"
"conn.ChannelDescriptor" <.down. "desc" "conn.Channel"

"net.Conn" <.. "conn"  "conn.MConnection"
"net.Conn" <.. "conn" "conn.Channel"
"net.Conn" <. "conn" "p2p.connSetItem"
"net.Conn" <. "conn" "p2p.peerConn"

"p2p.connSetItem" <.. "conn" "p2p.connSet"
"p2p.connSet" <.. "conns" "p2p.MultiplexTransport"
"p2p.ConnSet" <|- - "p2p.connSet"


"p2p.peerConn" *- - "p2p.peer"

"p2p.Transport" <|-up- "p2p.MultiplexTransport"
"p2p.transportLifecycle" <|-up- "p2p.MultiplexTransport"
"p2p.IPeerSet" <|- - "p2p.PeerSet"

"p2p.Peer" <|- - "p2p.peer"

"p2p.BaseReactor" <. "reactors" "p2p.Switch"
"p2p.PeerSet" <.. "peers" "p2p.Switch"
"p2p.MultiplexTransport" <. "transport" "p2p.Switch"

"p2p.Switch" <. "Switch" "p2p.BaseReactor"

"p2p.peer" <.. "list" "p2p.PeerSet"

@enduml

PlantUML version 1.2019.13(Wed Dec 11 01:18:29 CST 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 13.0.1+9
Operating System: Mac OS X
Default Encoding: UTF-8
Language: en
Country: CN
--></g></svg>